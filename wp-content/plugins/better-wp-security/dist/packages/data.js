(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[4735],{3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},29672:e=>{e.exports=function(){return this.wp.notices}()},31987:e=>{e.exports=function(){return this.wp.data}()},66087:e=>{"use strict";e.exports=window.lodash},77172:e=>{e.exports=function(){return this.wp.url}()},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},96691:(e,t,r)=>{"use strict";r.r(t),r.d(t,{BANS_STORE_NAME:()=>Ke,CORE_STORE_NAME:()=>Mt,HELP_STORE_NAME:()=>st,MODULES_STORE_NAME:()=>lt,apiFetch:()=>G,apiFetchBatch:()=>J,apiFetchResult:()=>M,awaitPromise:()=>W,controls:()=>ee,coreStore:()=>ac,createNotice:()=>z,dispatch:()=>$,fetch:()=>j,firewallStore:()=>$u,logsStore:()=>To,modulesStore:()=>Nr,parseFetchResponse:()=>K,patchstackStore:()=>Wn,select:()=>Y,siteScannerStore:()=>qn,toolsStore:()=>ts,trustedDevicesStore:()=>al,updateSettings:()=>X,userSecurityStore:()=>tu,vulnerabilitiesStore:()=>Ms});var s={};r.r(s),r.d(s,{FAILED_CREATE_BAN:()=>Re,FAILED_DELETE_BAN:()=>Ue,FAILED_QUERY:()=>Te,FAILED_UPDATE_BAN:()=>Qe,FINISH_CREATE_BAN:()=>Ae,FINISH_DELETE_BAN:()=>Le,FINISH_QUERY:()=>qe,FINISH_UPDATE_BAN:()=>Pe,RECEIVE_BAN:()=>be,RECEIVE_QUERY:()=>_e,START_CREATE_BAN:()=>ve,START_DELETE_BAN:()=>xe,START_QUERY:()=>he,START_UPDATE_BAN:()=>Ne,createBan:()=>me,deleteBan:()=>Se,failedCreateBan:()=>ce,failedDeleteBan:()=>Ee,failedUpdateBan:()=>de,fetchQueryNextPage:()=>ie,finishCreateBan:()=>ae,finishDeleteBan:()=>pe,finishUpdateBan:()=>ge,path:()=>re,query:()=>se,receiveBan:()=>oe,receiveQuery:()=>ue,refreshQuery:()=>ne,startCreateBan:()=>le,startDeleteBan:()=>fe,startUpdateBan:()=>ye,updateBan:()=>Ie});var n={};r.r(n),r.d(n,{getBan:()=>Ve,getBans:()=>Ce,getQueryHeader:()=>we,getQueryHeaderLink:()=>Oe,getQueryHeaderLinks:()=>ke,getQueryParams:()=>He,getQueryResults:()=>Fe,isDeleting:()=>Ge,isQuerying:()=>Me,isUpdating:()=>Be});var i={};r.r(i),r.d(i,{getBans:()=>Ye});var u={};r.r(u),r.d(u,{RECEIVE_HELP:()=>ze,enableHelp:()=>Xe,fetchHelp:()=>We});var o={};r.r(o),r.d(o,{getHelp:()=>Ze,isEnabled:()=>et});var l={};r.r(l),r.d(l,{getHelp:()=>tt});var c={};r.r(c),r.d(c,{EDIT_MODULE:()=>Pt,EDIT_SETTING:()=>Ft,EDIT_SETTINGS:()=>Ct,FAILED_SAVING_MODULES:()=>Lt,FAILED_SAVING_SETTINGS:()=>Ht,FINISH_SAVING_MODULES:()=>Ut,FINISH_SAVING_SETTINGS:()=>Vt,RECEIVE_MODULE:()=>Nt,RECEIVE_MODULES:()=>bt,RECEIVE_SETTINGS:()=>Dt,RESET_MODULE_EDITS:()=>Qt,RESET_SETTING_EDIT:()=>Ot,RESET_SETTING_EDITS:()=>kt,START_SAVING_MODULES:()=>xt,START_SAVING_SETTINGS:()=>wt,activateModule:()=>dt,deactivateModule:()=>gt,editModule:()=>ct,editSetting:()=>pt,editSettings:()=>Et,fetchModules:()=>Tt,receiveModule:()=>At,receiveModules:()=>vt,receiveSettings:()=>Rt,resetModuleEdits:()=>yt,resetSettingEdits:()=>mt,saveModules:()=>at,saveSettings:()=>It,setModulesStatus:()=>ft,updateSettings:()=>St,validateSettings:()=>_t});var a={};r.r(a),r.d(a,{__unstableGetAllEditedSettings:()=>yr,__unstableGetAllSettings:()=>ar,areSettingsDirty:()=>lr,getActiveModules:()=>Kt,getDirtyModules:()=>Zt,getDirtySettings:()=>or,getEditedModule:()=>jt,getEditedModules:()=>$t,getEditedSetting:()=>ir,getEditedSettings:()=>nr,getError:()=>cr,getModule:()=>Wt,getModuleEdits:()=>zt,getModules:()=>Yt,getSetting:()=>rr,getSettingEdits:()=>sr,getSettingSchema:()=>dr,getSettings:()=>tr,getSettingsConditionalSchema:()=>fr,isActive:()=>Xt,isModuleDirty:()=>er,isSavingModule:()=>Jt,isSavingSettings:()=>ur});var y={};r.r(y),r.d(y,{__unstableGetAllEditedSettings:()=>Sr,__unstableGetAllSettings:()=>Ir,getActiveModules:()=>Tr,getEditedModule:()=>qr,getEditedModules:()=>_r,getEditedSetting:()=>Rr,getEditedSettings:()=>Ar,getModule:()=>hr,getModules:()=>pr,getSetting:()=>vr,getSettings:()=>mr});var d={};r.r(d),r.d(d,{FAILED_TOGGLE_TOOL:()=>Fr,FINISH_TOGGLE_TOOL:()=>Or,FINISH_TOOL:()=>Dr,RECEIVE_TOOLS:()=>Lr,START_TOGGLE_TOOL:()=>Cr,START_TOOL:()=>Ur,fetchTools:()=>Pr,runTool:()=>Qr,toggleTool:()=>xr});var g={};r.r(g),r.d(g,{getLastError:()=>Wr,getLastResult:()=>jr,getResolvedTools:()=>Hr,getRunning:()=>Yr,getTool:()=>Mr,getTools:()=>Vr,getToolsConfig:()=>Gr,isRunning:()=>$r,isUpdating:()=>Kr});var f={};r.r(f),r.d(f,{getResolvedTools:()=>Jr,getTool:()=>Zr,getTools:()=>zr});var E={};r.r(E),r.d(E,{FAILED_ACTION:()=>hs,FAILED_QUERY:()=>Is,FINISH_ACTION:()=>_s,FINISH_QUERY:()=>ms,RECEIVE_QUERY:()=>Es,RECEIVE_VULNERABILITY:()=>qs,START_ACTION:()=>Ss,START_QUERY:()=>ps,applyVulnerabilityAction:()=>ds,deactivateSoftware:()=>ys,fetchQueryNextPage:()=>os,fetchQueryPrevPage:()=>us,fixVulnerability:()=>as,muteVulnerability:()=>cs,query:()=>ns,receiveQuery:()=>gs,receiveVulnerability:()=>fs,refreshQuery:()=>is});var p={};r.r(p),r.d(p,{getQueryHeader:()=>Qs,getQueryHeaderLink:()=>Rs,getQueryHeaderLinks:()=>bs,getQueryParams:()=>xs,getQueryResults:()=>vs,getVulnerabilities:()=>Ts,getVulnerability:()=>Ls,getVulnerabilityActions:()=>Ds,getVulnerabilityById:()=>Us,hasQueried:()=>As,isApplyingAction:()=>ws,isDeactivatingSoftware:()=>ks,isFixing:()=>Os,isMuting:()=>Fs,isQuerying:()=>Cs,queryHasNextPage:()=>Ps,queryHasPrevPage:()=>Ns});var m={};r.r(m),r.d(m,{getVulnerabilities:()=>Hs,getVulnerabilityById:()=>Vs});var I={};r.r(I),r.d(I,{FAILED_QUERY:()=>nn,FAILED_SCAN:()=>cn,FINISH_QUERY:()=>sn,FINISH_SCAN:()=>ln,RECEIVE_QUERY:()=>tn,RECEIVE_SCAN:()=>un,START_QUERY:()=>rn,START_SCAN:()=>on,fetchQueryNextPage:()=>Xs,fetchQueryPrevPage:()=>Ws,query:()=>js,receiveQuery:()=>en,receiveScan:()=>Zs,refreshQuery:()=>Ks,runScan:()=>Js});var S={};r.r(S),r.d(S,{getQueryHeader:()=>fn,getQueryHeaderLink:()=>dn,getQueryHeaderLinks:()=>gn,getQueryParams:()=>En,getQueryResults:()=>yn,getScan:()=>pn,getScans:()=>an,isQuerying:()=>mn,isScanning:()=>In});var _={};r.r(_),r.d(_,{getScans:()=>Sn});var h={};r.r(h),r.d(h,{FAILED_QUERY:()=>Un,FINISH_QUERY:()=>Ln,RECEIVE_QUERY:()=>Dn,START_QUERY:()=>xn,fetchQueryNextPage:()=>Nn,fetchQueryPrevPage:()=>bn,query:()=>An,receiveQuery:()=>Qn,refreshQuery:()=>Rn});var q={};r.r(q),r.d(q,{getLastFetchError:()=>Mn,getPatchstackVulnerabilities:()=>Cn,getPatchstackVulnerability:()=>Fn,getQueryHeader:()=>Hn,getQueryHeaderLink:()=>kn,getQueryHeaderLinks:()=>wn,getQueryParams:()=>Vn,getQueryResults:()=>On,isQuerying:()=>Yn,queryHasNextPage:()=>Bn,queryHasPrevPage:()=>Gn});var T={};r.r(T),r.d(T,{getPatchstackVulnerabilities:()=>$n});var v={};r.r(v),r.d(v,{CLOSE_QUICK_EDIT:()=>Pi,CONFIRM_QUICK_EDIT:()=>Qi,FAILED_ACTION:()=>Ti,FAILED_QUERY:()=>_i,FINISH_ACTION:()=>qi,FINISH_QUERY:()=>Si,OPEN_QUICK_EDIT:()=>Ni,RECEIVE_QUERY:()=>mi,RECEIVE_USER:()=>vi,REMOVE_SELECTED_USERS:()=>xi,START_ACTION:()=>hi,START_QUERY:()=>Ii,TOGGLE_SELECTED_USER:()=>Ri,TOGGLE_SELECT_ALL:()=>bi,UPDATE_SELECTION_TYPE:()=>Ai,applyQueryActionsToUsers:()=>li,applyQuickActionsToQuery:()=>oi,closeQuickEdit:()=>Ei,confirmQuickEdit:()=>pi,fetchQueryNextPage:()=>si,fetchQueryPrevPage:()=>ri,openQuickEdit:()=>fi,query:()=>ei,quickEditsSuccessSnackbar:()=>ci,receiveQuery:()=>ii,receiveUser:()=>ui,refreshQuery:()=>ti,removeSelectedUsers:()=>gi,toggleSelectAll:()=>yi,toggleSelectedUser:()=>di,updateUserSelectionType:()=>ai});var A={};r.r(A),r.d(A,{getCurrentlySelectedUsers:()=>Yi,getQueryHeader:()=>ki,getQueryHeaderLink:()=>Di,getQueryHeaderLinks:()=>Ci,getQueryParams:()=>wi,getQueryResults:()=>Ui,getQuickActionsError:()=>Mi,getQuickEditActions:()=>Xi,getQuickEditState:()=>Wi,getSelectAllState:()=>$i,getUser:()=>Hi,getUserById:()=>Vi,getUserSelectionType:()=>Bi,getUsers:()=>Li,isApplyingQuickActions:()=>Gi,isQuerying:()=>ji,isUserSelected:()=>Ki,queryHasNextPage:()=>Oi,queryHasPrevPage:()=>Fi});var R={};r.r(R),r.d(R,{getUserById:()=>Ji,getUsers:()=>zi});var b={};r.r(b),r.d(b,{FAILED_QUERY:()=>_u,FINISH_QUERY:()=>Su,RECEIVE_ITEM:()=>mu,RECEIVE_QUERY:()=>pu,START_QUERY:()=>Iu,deleteItem:()=>fu,editItem:()=>cu,fetchQueryNextPage:()=>ou,fetchQueryPrevPage:()=>uu,query:()=>nu,refreshQuery:()=>iu,resetAllEdits:()=>yu,resetEdits:()=>au,saveEditedItem:()=>du,saveItem:()=>gu});var N={};r.r(N),r.d(N,{getEditedItem:()=>Lu,getFirewallRules:()=>hu,getItem:()=>Pu,getItemById:()=>Qu,getLastDeleteError:()=>Ou,getLastSaveError:()=>Fu,getQueryHeader:()=>bu,getQueryHeaderLink:()=>Tu,getQueryHeaderLinks:()=>vu,getQueryParams:()=>Nu,getQueryResults:()=>qu,isDeleting:()=>Cu,isDirty:()=>Uu,isQuerying:()=>xu,isSaving:()=>Du,queryHasNextPage:()=>Ru,queryHasPrevPage:()=>Au});var P={};r.r(P),r.d(P,{getEditedItem:()=>wu,getFirewallRules:()=>ku,getItemById:()=>Hu});var Q={};r.r(Q),r.d(Q,{FAILED_QUERY:()=>io,FINISH_QUERY:()=>no,RECEIVE_LOG:()=>uo,RECEIVE_QUERY:()=>ro,START_QUERY:()=>so,fetchQueryNextPage:()=>Ju,fetchQueryPrevPage:()=>zu,query:()=>Wu,receiveLog:()=>to,receiveQuery:()=>eo,refreshQuery:()=>Xu});var x={};r.r(x),r.d(x,{getLog:()=>mo,getLogById:()=>Io,getLogs:()=>oo,getQueryHeader:()=>fo,getQueryHeaderLink:()=>co,getQueryHeaderLinks:()=>ao,getQueryParams:()=>Eo,getQueryResults:()=>lo,isQuerying:()=>po,queryHasNextPage:()=>go,queryHasPrevPage:()=>yo});var L={};r.r(L),r.d(L,{getLogById:()=>_o,getLogs:()=>So});var U={};r.r(U),r.d(U,{FAILED_QUERY:()=>Vo,FINISH_QUERY:()=>Ho,RECEIVE_ITEM:()=>ko,RECEIVE_QUERY:()=>Oo,START_QUERY:()=>wo,editItem:()=>Qo,fetchQueryNextPage:()=>No,fetchQueryPrevPage:()=>bo,query:()=>Ao,refreshQuery:()=>Ro,resetAllEdits:()=>Lo,resetEdits:()=>xo,saveEditedItem:()=>Uo,saveEditedItems:()=>Do,saveItem:()=>Co});var D={};r.r(D),r.d(D,{getDirtyItems:()=>el,getEditedItem:()=>Zo,getItem:()=>Xo,getItemById:()=>zo,getLastSaveError:()=>nl,getQueryHeader:()=>jo,getQueryHeaderLink:()=>Go,getQueryHeaderLinks:()=>Mo,getQueryParams:()=>Ko,getQueryResults:()=>Bo,getQueryUser:()=>Wo,isDirty:()=>tl,isQuerying:()=>Jo,isSaving:()=>rl,isSavingAnyItems:()=>sl,queryHasNextPage:()=>$o,queryHasPrevPage:()=>Yo});var C={};r.r(C),r.d(C,{getActorTypes:()=>_l,getActors:()=>hl,getBatchMaxItems:()=>vl,getCurrentUser:()=>dl,getCurrentUserId:()=>gl,getFeatureFlags:()=>Tl,getIndex:()=>pl,getInstallType:()=>Rl,getRequirementsInfo:()=>Sl,getRoles:()=>Il,getSchema:()=>ml,getServerType:()=>Al,getSiteInfo:()=>ql,getUser:()=>yl,hasPatchstack:()=>bl,isLiquidWebCustomer:()=>Nl,isSavingCurrentUser:()=>El,isSavingUser:()=>fl});var F={};r.r(F),r.d(F,{LOAD_INITIAL_FEATURE_FLAGS:()=>jl,RECEIVE_ACTORS:()=>Yl,RECEIVE_ACTOR_TYPES:()=>Ml,RECEIVE_BATCH_MAX_ITEMS:()=>Kl,RECEIVE_CURRENT_USER_ID:()=>Gl,RECEIVE_INDEX:()=>Vl,RECEIVE_SITE_INFO:()=>$l,RECEIVE_USER:()=>Bl,__unstableLoadInitialFeatureFlags:()=>wl,fetchIndex:()=>Pl,fetchUser:()=>Ul,receiveActorTypes:()=>Fl,receiveActors:()=>Ol,receiveBatchMaxItems:()=>Hl,receiveCurrentUserId:()=>Cl,receiveIndex:()=>Ql,receiveSiteInfo:()=>kl,receiveUser:()=>Dl,saveCurrentUser:()=>xl,saveUser:()=>Ll});var O={};r.r(O),r.d(O,{getActorTypes:()=>ic,getActors:()=>uc,getBatchMaxItems:()=>lc,getCurrentUser:()=>nc,getIndex:()=>Wl,getInstallType:()=>ec,getRequirementsInfo:()=>Jl,getRoles:()=>zl,getSchema:()=>Xl,getServerType:()=>Zl,getSiteInfo:()=>oc,getUser:()=>sc,hasPatchstack:()=>tc,isLiquidWebCustomer:()=>rc});var k=r(31987),w=r(66087),H=r(85631),V=r.n(H),B=r(62932);function G(e){return{type:"API_FETCH",request:e}}function M(e){return{type:"API_FETCH_RESULT",request:e}}function Y(e,t,...r){return{type:"SELECT",storeKey:e,selectorName:t,args:r}}function $(e,t,...r){return{type:"DISPATCH",storeKey:e,actionName:t,args:r}}function j(e,t){return{type:"FETCH",request:e,init:t}}function K(e){return{type:"PARSE_FETCH_RESPONSE",response:e}}function W(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function X(e,t){return{type:"UPDATE_SETTINGS",module:e,settings:t}}function z(e="info",t,r={}){return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}function J(e){return{type:"API_FETCH_BATCH",batch:e}}const Z={AWAIT_PROMISE:({promise:e,delay:t})=>{return t?Promise.all([e,(r=t,new Promise((e=>setTimeout(e,r))))]):e;var r},API_FETCH:({request:e})=>V()(e).catch(B.dD),API_FETCH_RESULT:({request:e})=>V()({...e,parse:!1}).then(B.Q7.fromResponse).catch(B.dD).catch((e=>e.getResponse?B.Q7.fromResponse(e.getResponse()):new B.Q7(B.Q7.ERROR,new B.AR("unknown_error","Unknown error")))),SELECT({storeKey:e,selectorName:t,args:r}){const s=(0,k.select)(e)[t];return s.hasResolver?(({storeKey:e,selectorName:t,args:r})=>new Promise((s=>{const n=()=>(0,k.select)("core/data").hasFinishedResolution(e,t,r),i=()=>(0,k.select)(e)[t].apply(null,r),u=i();if(n())return s(u);const o=(0,k.subscribe)((()=>{n()&&(o(),s(i()))}))})))({storeKey:e,selectorName:t,args:r}):s(...r)},DISPATCH:({storeKey:e,actionName:t,args:r})=>(0,k.dispatch)(e)[t](...r),PARSE_FETCH_RESPONSE:async function({response:e}){return await e.json()},FETCH:({request:e,init:t})=>window.fetch(e,t),UPDATE_SETTINGS:(0,k.createRegistryControl)((e=>({module:t,settings:r})=>e.dispatch("ithemes-security/modules").updateSettings(t,r))),CREATE_NOTICE({status:e,content:t,options:r}){r.autoDismiss&&(r.id=r.id||(0,w.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,k.dispatch)("core/notices").removeNotice(r.id,r.context)),r.autoDismiss)),(0,k.dispatch)("core/notices").createNotice(e,t,r)},API_FETCH_BATCH:(0,k.createRegistryControl)((e=>async({batch:t})=>{const r=await e.resolveSelect(Mt).getBatchMaxItems(),s=(0,w.chunk)(t,r||25),n=[],i=[];if(!s.length)return[];for(const e of s)try{const t=await Z.API_FETCH({request:{path:"/batch/v1",method:"POST",data:{requests:e}}});i.push(...t.responses)}catch(t){n.push(t),i.push(...(0,w.times)(e.length,(0,w.constant)({body:t,status:500,headers:{}})))}if(n.length===s.length)throw n[0];return i}))},ee=Z;var te=r(77172);const re="/ithemes-security/v1/bans";function*se(e,t={}){let r,s;yield{type:he,queryId:e,queryParams:t};try{r=yield G({path:(0,te.addQueryArgs)(re,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:Te,queryId:e,queryParams:t,error:r},r}return yield ue(e,t.context||"view",r,s,"replace"),yield{type:qe,queryId:e,queryParams:t,response:r},r}function*ne(e){const t=yield Y("ithemes-security/bans","getQueryParams",e);yield*se(e,t)}function*ie(e,t="append"){const r=yield Y("ithemes-security/bans","getQueryHeaderLink",e,"next");if(!r)return[];let s,n;yield{type:he,queryId:e};try{s=yield G({url:r.link,parse:!1}),n=yield K(s)}catch(t){return yield{type:Te,queryId:e,error:t},t}const i=(0,te.getQueryArg)(r.link,"context")||"view";return yield ue(e,i,s,n,t),yield{type:qe,queryId:e,response:s},s}function ue(e,t,r,s,n){return{type:_e,queryId:e,context:t,response:r,items:s,mode:n}}function oe(e){return{type:be,ban:e}}function le(e){return{type:ve,ban:e}}function ce(e,t){return{type:Re,ban:e,error:t}}function ae(e,t){return{type:Ae,ban:e,response:t}}function ye(e,t){return{type:Ne,self:e,ban:t}}function de(e,t){return{type:Qe,self:e,error:t}}function ge(e,t){return{type:Pe,self:e,response:t}}function fe(e){return{type:xe,self:e}}function Ee(e,t){return{type:Ue,self:e,error:t}}function pe(e){return{type:Le,self:e}}function*me(e,t){const r={method:"POST",data:t};let s;(0,te.isURL)(e)?r.url=e:r.path=`${re}/${e}`,yield le(t);try{s=yield G(r)}catch(e){return yield ce(t,e),e}return yield ae(t,s),yield oe(s),s}function*Ie(e,t){const r=(0,w.isObject)(e)?(0,B.Ng)(e):e;let s;yield ye(r,t);try{s=yield G({url:r,method:"PUT",data:t})}catch(e){return yield de(r,e),e}return yield ge(r,s),yield oe(s),s}function*Se(e){const t=(0,w.isObject)(e)?(0,B.Ng)(e):e;yield fe(t);try{yield G({url:t,method:"DELETE"})}catch(e){return yield Ee(t,e),e}return yield pe(t),null}const _e="RECEIVE_QUERY",he="START_QUERY",qe="FINISH_QUERY",Te="FAILED_QUERY",ve="START_CREATE_BAN",Ae="FINISH_CREATE_BAN",Re="FAILED_CREATE_BAN",be="RECEIVE_BAN",Ne="START_UPDATE_BAN",Pe="FINISH_UPDATE_BAN",Qe="FAILED_UPDATE_BAN",xe="START_DELETE_BAN",Le="FINISH_DELETE_BAN",Ue="FAILED_DELETE_BAN";var De=r(84156);const Ce=(0,k.createRegistrySelector)((e=>()=>e("ithemes-security/bans").getQueryResults("main"))),Fe=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Oe(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function ke(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function we(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function He(e,t){return(0,w.get)(e,["queryParams",t])}function Ve(e,t){return e.bySelf[t]}function Be(e,t){const r=(0,w.isObject)(t)?(0,B.Ng)(t):t;return e.updating.includes(r)}function Ge(e,t){const r=(0,w.isObject)(t)?(0,B.Ng)(t):t;return e.deleting.includes(r)}function Me(e,t){return e.querying.includes(t)}function*Ye(){yield $("ithemes-security/bans","query","main",{per_page:100})}var $e=r(50030);const je={bySelf:{},queries:{},queryParams:{},querying:[],creating:[],updating:[],deleting:[]},Ke="ithemes-security/bans";function*We(e){const t=`https://ithemes.com/wp-json/ithemes/v1/inline-help/itsec/${encodeURIComponent(e)}`,r=yield j(t,{credentials:"omit",referrer:"no-referrer"});if(!r.ok)return;if(r.status>=400)return;const s=yield K(r);yield{type:ze,topic:e,help:s}}function*Xe(e=!0){yield X("global",{enable_remote_help:e})}(0,k.register)((0,k.createReduxStore)(Ke,{controls:ee,actions:s,selectors:n,resolvers:i,reducer:function(e=je,t){switch(t.type){case _e:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))}};case he:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case qe:case Te:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case be:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.ban)]:{context:"edit",item:t.ban}}};case ve:return{...e,creating:[...e.creating,t.ban]};case Ae:case Re:return{...e,creating:e.creating.filter((e=>e!==t.ban))};case Ne:return{...e,updating:[...e.updating,t.self]};case Pe:case Qe:return{...e,updating:e.updating.filter((e=>e!==t.self))};case xe:return{...e,deleting:[...e.deleting,t.self],bySelf:(0,w.omit)(e.bySelf,[t.self])};case Le:case Ue:return{...e,deleting:e.deleting.filter((e=>e!==t.self))};default:return e}}}));const ze="RECEIVE_HELP",Je=[];function Ze(e,t){return e.byTopic[t]||Je}const et=(0,k.createRegistrySelector)((e=>()=>e("ithemes-security/modules").getSettings("global")?.enable_remote_help));function*tt(e){yield We(e)}const rt={byTopic:{}},st="ithemes-security/help",nt=(0,k.createReduxStore)(st,{controls:ee,actions:u,selectors:o,resolvers:l,reducer:function(e=rt,t){return t.type===ze?{...e,byTopic:{...e.byTopic,[t.topic]:t.help}}:e}});(0,k.register)(nt);var it=r(41795),ut=r(83846),ot=r(3075);const lt="ithemes-security/modules";function*ct(e,t){const r=yield k.controls.select(lt,"getModule",e);r?yield{type:Pt,module:e,edit:(0,it.A)(r,t)}:yield{type:Pt,module:e,edit:t}}function*at(e=!0){if(!0===e?e=yield k.controls.select(lt,"getDirtyModules"):(0,w.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const r of e){const e=yield k.controls.select(lt,"getModuleEdits",r);t.push({method:"PUT",path:`/ithemes-security/v1/modules/${r}`,body:e})}let r;try{yield{type:xt,modules:e},r=yield J(t)}catch(t){return yield{type:Lt,modules:e},yield z("error",t.message),t}const s=[],n={};for(let i=0;i<t.length;i++){const t=e[i],u=r[i];u.status>=400?n[t]=u.body:(s.push(t),yield At(u.body))}return(0,w.isEmpty)(n)||(yield{type:Lt,errors:n}),s.length&&(yield{type:Ut,modules:s}),r}function*yt(e=!0){!0===e?e=yield k.controls.select(lt,"getDirtyModules"):(0,w.isString)(e)&&(e=[e]),yield{type:Qt,modules:e}}function*dt(e){try{const t=yield qt(e,"active");yield At(t),yield{type:Ut,modules:[e]},t.side_effects&&(yield Tt()),yield z("success",(0,ot.__)("Activated feature","better-wp-security"),{type:"snackbar"})}catch(t){yield{type:Lt,errors:{[e]:t}}}}function*gt(e){try{const t=yield qt(e,"inactive");yield At(t),yield{type:Ut,modules:[e]},t.side_effects&&(yield Tt()),yield z("success",(0,ot.__)("Deactivated feature","better-wp-security"),{type:"snackbar"})}catch(t){yield{type:Lt,errors:{[e]:t}}}}function*ft(e){const t={requests:(0,w.map)(e,((e,t)=>({path:`/ithemes-security/v1/modules/${t}`,method:"PUT",body:{status:{selected:e}}})))},r=yield J(t);for(let e=0;e<r.length;e++){const t=r[e];t.status>=400?yield z("error",t.body.message):yield At(t.body)}}function*Et(e,t){const r=yield k.controls.select(lt,"getSettings",e);if(!r)return void(yield{type:Ct,module:e,edit:t});const s={};let n=!1;for(const e in t)t.hasOwnProperty(e)&&((0,w.isEqual)(t[e],r[e])||(s[e]=t[e],n=!0));n?yield{type:Ct,module:e,edit:s}:yield mt(e)}function*pt(e,t,r){const s=yield k.controls.select(lt,"getSetting",e,t);(0,w.isEqual)(s,r)?yield{type:Ot,module:e,setting:t}:yield{type:Ft,module:e,setting:t,value:r}}function*mt(e=!0){!0===e?e=yield k.controls.select(lt,"getDirtySettings"):(0,w.isString)(e)&&(e=[e]),yield{type:kt,modules:e}}function*It(e=!0,t=!1){if(!0===e?e=yield k.controls.select(lt,"getDirtySettings"):(0,w.isString)(e)&&(e=[e]),!e.length)return[];const r=[],s=[],n={};for(const i of e){if(t){const e=yield k.controls.dispatch(lt,"validateSettings",i);if(!0!==e){const t=new B.AR("local_validation_failed");e.errorText.forEach((e=>t.add("local_validation_failed",e))),n[i]=t;continue}}const e=yield k.controls.select(lt,"getSettingEdits",i);s.push(i),r.push({method:"PATCH",path:`/ithemes-security/v1/settings/${i}`,body:e})}let i;try{yield{type:wt,modules:e},i=yield J(r)}catch(t){return yield{type:Ht,modules:e},yield z("error",t.message),t}const u=[];for(let e=0;e<r.length;e++){const t=s[e],r=i[e];r.status>=400?n[t]=r.body:(u.push(t),yield Rt(t,r.body))}return(0,w.isEmpty)(n)||(yield{type:Ht,errors:n}),u.length&&(yield z("success",(0,ot.__)("Saved settings.","better-wp-security"),{type:"snackbar"}),yield{type:Vt,modules:u}),i}function*St(e,t){let r;yield{type:wt,modules:[e]};try{r=yield G({path:`/ithemes-security/v1/settings/${e}`,method:"PATCH",data:t}),yield Rt(e,r)}catch(t){return yield{type:Ht,errors:{[e]:t}},t}return yield{type:Vt,modules:[e]},r}const _t=e=>async({select:t,resolveSelect:r})=>{const s=await r.getSettingsConditionalSchema(e);if(!s)return!0;const n=t.getEditedSettings(e),i=(0,B.qD)();return!!i.validate(s,n)||{errors:i.errors,errorText:ht(i.errors,e,s)}};function ht(e,t,r){const s=[];for(const{message:n,schemaPath:i,dataPath:u}of e){let e=ut.OG.create(i),o=e.parent(r);for(;o&&!o.title;)e=ut.OG.create(e.path.slice(0,e.path.length-1)),o=e.parent(r);o?.title?s.push(`${o.title} ${n}.`):s.push(`${t}${u} ${n}.`)}return s}function qt(e,t){return G({method:"PUT",path:`/ithemes-security/v1/modules/${e}`,data:{status:{selected:t}}})}function*Tt(){const e=yield G({path:"/ithemes-security/v1/modules?context=edit&_embed=1"});yield vt(e)}function vt(e){return{type:bt,modules:e}}function At(e){return{type:Nt,module:e}}function Rt(e,t){return{type:Dt,module:e,settings:t}}const bt="RECEIVE_MODULES",Nt="RECEIVE_MODULE",Pt="EDIT_MODULE",Qt="RESET_MODULE_EDITS",xt="START_SAVING_MODULES",Lt="FAILED_SAVING_MODULES",Ut="FINISH_SAVING_MODULES",Dt="RECEIVE_SETTINGS",Ct="EDIT_SETTINGS",Ft="EDIT_SETTING",Ot="RESET_SETTING_EDIT",kt="RESET_SETTING_EDITS",wt="START_SAVING_SETTINGS",Ht="FAILED_SAVING_SETTINGS",Vt="FINISH_SAVING_SETTINGS";var Bt=r(98616),Gt=r.n(Bt);const Mt="ithemes-security/core";function Yt(e){return e.modules}const $t=(0,De.A)((e=>e.modules.map((t=>({...t,...e.moduleEdits[t.id]||{}})))),(e=>[e.modules,e.moduleEdits])),jt=(0,De.A)(((e,t)=>{const r=Wt(e,t);return r?{...r,...e.moduleEdits[t]||{}}:null}),((e,t)=>[e.modules,e.moduleEdits[t]])),Kt=(0,De.A)((e=>e.modules.filter((e=>"active"===e.status.selected)).map((e=>e.id))),(e=>e.modules));function Wt(e,t){return e.modules.find((e=>e.id===t))}function Xt(e,t){return"active"===Wt(e,t)?.status.selected}function zt(e,t){return e.moduleEdits[t]}function Jt(e,t){return e.savingModules.includes(t)}function Zt(e){return Object.keys(e.moduleEdits)}function er(e,t){return!!e.moduleEdits[t]}function tr(e,t){var r;return null!==(r=e.settings[t])&&void 0!==r?r:{}}function rr(e,t,r){return e.settings[t]?.[r]}function sr(e,t){return e.settingEdits[t]}const nr=(0,De.A)(((e,t)=>({...e.settings[t]||{},...e.settingEdits[t]||{}})),((e,t)=>[e.settings[t],e.settingEdits[t]]));function ir(e,t,r){var s;return null!==(s=e.settingEdits[t]?.[r])&&void 0!==s?s:e.settings[t]?.[r]}function ur(e,t){return Array.isArray(t)?e.savingSettings.some((e=>t.includes(e))):e.savingSettings.includes(t)}function or(e){return Object.keys(e.settingEdits)}function lr(e,t){return e.settingEdits[t]&&!(0,w.isEmpty)(e.settingEdits[t])}function cr(e,t){return e.errors[t]}function ar(e){return e.settings}const yr=(0,De.A)((e=>(0,w.reduce)(e.settings,((t,r,s)=>(t[s]={...r,...e.settingEdits[s]||{}},t)),{})),(e=>[e.settings,e.settingEdits]));function dr(e,t,r){return Wt(e,t)?.settings?.schema.properties[r]}const gr=Gt()(((e,t,r,s,n,i,u,o)=>{const l={select:t,serverType:r,installType:s,featureFlags:n,activeModules:i,settings:u,userGroupsBySetting:o},c=t=>((e,t,r)=>{const{serverType:s,installType:n,activeModules:i,settings:u,featureFlags:o,userGroupsBySetting:l}=r;if(e["server-type"]&&!e["server-type"].includes(s))return!1;if(e["install-type"]&&e["install-type"]!==n)return!1;if(e["active-modules"])for(const t of e["active-modules"])if(!i.includes(t))return!1;if(e["user-groups"])for(const r of e["user-groups"])if(!l[t.id]?.[r]?.length)return!1;if(e["feature-flags"])for(const t of e["feature-flags"])if(!o?.includes(t))return!1;return!(e.settings&&!(0,B.qD)().compile(e.settings)(u))})(t,e,l),a=(t,r)=>r.properties?{...r,properties:Object.entries(r.properties).reduce(((r,[s,n])=>{const i=`${t}.${s}`;return e.settings.conditional[i]&&!c(e.settings.conditional[i])||(r[s]=a(i,n)),r}),{})}:r,y=Object.entries(e.settings.schema.properties).reduce(((t,[r,s])=>e.settings.interactive.includes(r)?(e.settings.conditional[r]&&!c(e.settings.conditional[r])||(t[r]=a(r,s)),t):t),{}),{id:d,...g}=e.settings.schema;return{...g,properties:y}})),fr=(0,k.createRegistrySelector)((e=>(t,r)=>{const s=jt(t,r);return s?.settings?gr(s,e,e(Mt).getServerType(),e(Mt).getInstallType(),e(Mt).getFeatureFlags(),Kt(t),nr(t,r),e("ithemes-security/user-groups-editor").getEditedGroupsBySetting()):null})),Er={modules:[],moduleEdits:{},savingModules:[],settings:{},settingEdits:{},savingSettings:[],errors:{}};function*pr(){yield Tt()}const mr={*fulfill(e){const t=yield G({path:`/ithemes-security/v1/settings/${e}`});yield Rt(e,t)},isFulfilled:(e,t)=>e.settings.hasOwnProperty(t)},Ir={*fulfill(){yield k.controls.resolveSelect(lt,"getModules")},isFulfilled:e=>!(0,w.isEmpty)(e.settings)};function*Sr(){yield k.controls.resolveSelect(lt,"__unstableGetAllSettings")}function*_r(){yield k.controls.resolveSelect(lt,"getModules")}const hr={*fulfill(){yield k.controls.resolveSelect(lt,"getModules")},isFulfilled:(e,t)=>e.modules.includes((e=>e.id===t))};function*qr(){yield k.controls.resolveSelect(lt,"getModules")}function*Tr(){yield k.controls.resolveSelect(lt,"getModules")}function*vr(e){yield k.controls.resolveSelect(lt,"getSettings",e)}function*Ar(e){yield k.controls.resolveSelect(lt,"getSettings",e)}function*Rr(e){yield k.controls.resolveSelect(lt,"getSettings",e)}const br=(0,k.createReduxStore)(lt,{controls:ee,actions:c,selectors:a,resolvers:y,reducer:function(e=Er,t){switch(t.type){case bt:return{...e,modules:[...t.modules],settings:{...e.settings,...t.modules.reduce(((e,t)=>{const r=(0,w.get)(t,["_embedded","ithemes-security:settings",0]);return r?{...e,[t.id]:r}:e}),{})}};case Nt:return{...e,modules:e.modules.map((e=>e.id===t.module.id?t.module:e)),settings:{...e.settings,[t.module.id]:(0,w.get)(t.module,["_embedded","ithemes-security:settings",0],e.settings[t.module.id])}};case Pt:return{...e,moduleEdits:{...e.moduleEdits,[t.module]:t.edit}};case Qt:return{...e,moduleEdits:(0,w.omit)(e.moduleEdits,t.modules)};case xt:return{...e,savingModules:[...e.savingModules,...t.modules]};case Ut:return{...e,savingModules:e.savingModules.filter((e=>!t.modules.includes(e))),moduleEdits:(0,w.omit)(e.moduleEdits,t.modules),errors:(0,w.omit)(e.errors,t.modules)};case Lt:return{...e,savingModules:(0,w.without)(e.savingModules,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};case Dt:return{...e,settings:{...e.settings,[t.module]:t.settings}};case Ct:return{...e,settingEdits:{...e.settingEdits,[t.module]:t.edit}};case Ft:return{...e,settingEdits:{...e.settingEdits,[t.module]:{...e.settingEdits[t.module]||{},[t.setting]:t.value}}};case Ot:return{...e,settingEdits:{...e.settingEdits,[t.module]:(0,w.omit)(e.settingEdits[t.module]||{},t.setting)}};case kt:return{...e,settingEdits:(0,w.omit)(e.settingEdits,t.modules)};case wt:return{...e,savingSettings:[...e.savingSettings,...t.modules]};case Vt:return{...e,savingSettings:e.savingSettings.filter((e=>!t.modules.includes(e))),settingEdits:(0,w.omit)(e.settingEdits,t.modules),errors:(0,w.omit)(e.errors,t.modules)};case Ht:return{...e,savingSettings:(0,w.without)(e.savingSettings,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};default:return e}},persist:["moduleEdits","settingEdits"]});(0,k.register)(br);const Nr=br;function*Pr(){const e=yield G({path:"/ithemes-security/v1/tools"});yield{type:Lr,tools:e}}function*Qr(e,t={}){let r;yield{type:Ur,tool:e,form:t};try{r=yield G({path:`/ithemes-security/v1/tools/${e}`,method:"POST",data:t,parse:!1})}catch(t){const r=yield W(B.Q7.fromResponse(t.getResponse()));return yield{type:Dr,tool:e,result:r},r}const s=yield W(B.Q7.fromResponse(r));return yield{type:Dr,tool:e,result:s},s}function*xr(e,t=!0){let r;yield{type:Cr,tool:e,enabled:t};try{r=yield G({path:`/ithemes-security/v1/tools/${e}`,method:"PUT",data:{enabled:t}})}catch(t){return yield{type:Fr,tool:e,error:t},t}return yield{type:Or,tool:e,data:r},r}const Lr="RECEIVE_TOOLS",Ur="START_TOOL",Dr="FINISH_TOOL",Cr="START_TOGGLE_TOOL",Fr="FAILED_TOGGLE_TOOL",Or="FINISH_TOGGLE_TOOL",kr="ithemes-security/tools",wr=Gt()(((e,t)=>e.map((e=>t[e.slug]||e))),{maxSize:1}),Hr=(0,k.createRegistrySelector)((e=>t=>wr(e(kr).getToolsConfig(),t.bySlug))),Vr=(0,De.A)((e=>e.slugs.map((t=>e.bySlug[t]))),(e=>[e.bySlug,e.slugs])),Br=Gt()((e=>e.reduce(((e,t)=>{for(const[r,s]of Object.entries(t.tools))e.push({slug:r,module:t.id,toggleable:!1,schedule:"",form:null,...s});return e}),[])),{maxSize:1}),Gr=(0,k.createRegistrySelector)((e=>()=>Br(e(lt).getModules()))),Mr=(0,k.createRegistrySelector)((e=>(t,r)=>t.bySlug[r]||e(kr).getToolsConfig().find((e=>r===e.slug))));function Yr(e){return e.running}function $r(e,t){return e.running.includes(t)}function jr(e,t){return e.lastResult[t]}function Kr(e,t){return e.updating.includes(t)}function Wr(e,t){return e.lastError[t]}const Xr={bySlug:{},slugs:[],running:[],lastResult:{},updating:[],lastError:{}};function*zr(){yield Pr()}function*Jr(){yield k.controls.resolveSelect(kr,"getTools")}const Zr={*fulfill(){yield k.controls.resolveSelect(kr,"getTools")},isFulfilled:(e,t)=>!!e.bySlug[t]},es=(0,k.createReduxStore)(kr,{controls:ee,actions:d,selectors:g,resolvers:f,reducer:function(e=Xr,t){switch(t.type){case Lr:return{...e,bySlug:(0,w.keyBy)(t.tools,"slug"),slugs:(0,w.map)(t.tools,"slug")};case Ur:return{...e,running:[...e.running,t.tool]};case Dr:return{...e,running:(0,w.without)(e.running,t.tool),lastResult:{...e.lastResult,[t.tool]:t.result}};case Cr:return{...e,updating:[...e.updating,t.tool]};case Fr:return{...e,updating:(0,w.without)(e.updating,t.tool),lastError:{...e.lastError,[t.tool]:t.error}};case Or:return{...e,updating:(0,w.without)(e.updating,t.tool),lastError:(0,w.omit)(e.lastError,t.tool),bySlug:{...e.bySlug,[t.tool]:t.data}};default:return e}}});(0,k.register)(es);const ts=es,rs="ithemes-security/vulnerabilities",ss="/ithemes-security/v1/site-scanner/vulnerabilities";function*ns(e,t={}){let r,s;yield{type:ps,queryId:e,queryParams:t};try{r=yield G({path:(0,te.addQueryArgs)(ss,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:Is,queryId:e,queryParams:t,error:r},r}return yield gs(e,t.context||"view",r,s,"replace"),yield{type:ms,queryId:e,queryParams:t,response:r},s}function*is(e){const t=yield Y(rs,"getQueryParams",e);yield*ns(e,t)}function*us(e,t="append"){return yield*ls(e,"prev",t)}function*os(e,t="append"){return yield*ls(e,"next",t)}function*ls(e,t,r){const s=yield Y(rs,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:ps,queryId:e};try{n=yield G({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:Is,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield gs(e,u,n,i,r),yield{type:ms,queryId:e,response:n},n}function*cs(e){return yield*ds(e,"ithemes-security:mute-vulnerability")}function*as(e){return yield*ds(e,"ithemes-security:fix-vulnerability")}function*ys(e){return yield*ds(e,"ithemes-security:deactivate-vulnerable-software")}function*ds(e,t){const r="string"==typeof e?yield k.controls.select(rs,"getVulnerability",e):e,s=(0,B.TE)(r,t);if(!s)return;const n=(0,B.Ng)(r);yield{type:Ss,rel:t,self:n};try{const e=yield G({url:s,method:"POST"});return yield{type:_s,rel:t,self:n},yield fs(e),e}catch(e){return yield{type:hs,rel:t,self:n,error:e},e}}function gs(e,t,r,s,n){return{type:Es,queryId:e,context:t,response:r,items:s,mode:n}}function fs(e){return{type:qs,vulnerability:e}}const Es="RECEIVE_QUERY",ps="START_QUERY",ms="FINISH_QUERY",Is="FAILED_QUERY",Ss="START_ACTION",_s="FINISH_ACTION",hs="FAILED_ACTION",qs="RECEIVE_VULNERABILITY",Ts=(0,k.createRegistrySelector)((e=>()=>e(rs).getQueryResults("main"))),vs=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function As(e,t){return!!e.queries[t]}function Rs(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function bs(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Ns(e,t){return!!Rs(e,t,"prev")}function Ps(e,t){return!!Rs(e,t,"next")}function Qs(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function xs(e,t){return(0,w.get)(e,["queryParams",t])}function Ls(e,t){return e.bySelf[t]?.item}function Us(e,t){return Ls(e,e.selfById[t])}function Ds(e,t){const r="string"==typeof t?Ls(e,t):t;return r?(0,w.reduce)(r._links,((e,t,r)=>t.reduce(((e,t)=>t.title?(e.push({rel:r,title:t.title,isDestructive:t.isDestructive||!1}),e):e),e)),[]):[]}function Cs(e,t){return e.querying.includes(t)}function Fs(e,t){return ws(e,t,"ithemes-security:mute-vulnerability")}function Os(e,t){return ws(e,t,"ithemes-security:fix-vulnerability")}function ks(e,t){return ws(e,t,"ithemes-security:deactivate-vulnerable-software")}function ws(e,t,r){const s="string"==typeof t?t:(0,B.Ng)(t);return e.actions.includes(`${r}:${s}`)}function*Hs(){yield $(rs,"query","main",{per_page:100,resolution:["unresolved","patched","deactivated"]})}function*Vs(e){const t=yield G({path:`${ss}/${e}`});return yield fs(t),t}const Bs={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],actions:[]},Gs=(0,k.createReduxStore)(rs,{actions:E,selectors:p,resolvers:m,controls:ee,reducer:function(e=Bs,t){switch(t.type){case Es:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case ps:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case ms:case Is:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case qs:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.vulnerability)]:{context:"edit",item:t.vulnerability}},selfById:{...e.selfById,[t.vulnerability.id]:(0,B.Ng)(t.vulnerability)}};case Ss:return{...e,actions:[...e.actions,`${t.rel}:${t.self}`]};case _s:case hs:return{...e,actions:e.actions.filter((e=>e!==`${t.rel}:${t.self}`))};default:return e}}});(0,k.register)(Gs);const Ms=Gs,Ys="ithemes-security/site-scanner",$s="/ithemes-security/v1/site-scanner/scans";function*js(e,t={}){let r,s;yield{type:rn,queryId:e,queryParams:t};try{r=yield G({path:(0,te.addQueryArgs)($s,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:nn,queryId:e,queryParams:t,error:r},r}return yield en(e,t.context||"view",r,s,"replace"),yield{type:sn,queryId:e,queryParams:t,response:r},r}function*Ks(e){const t=yield Y(Ys,"getQueryParams",e);yield*js(e,t)}function*Ws(e,t="append"){return yield*zs(e,"prev",t)}function*Xs(e,t="append"){return yield*zs(e,"next",t)}function*zs(e,t,r){const s=yield Y(Ys,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:rn,queryId:e};try{n=yield G({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:nn,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield en(e,u,n,i,r),yield{type:sn,queryId:e,response:n},n}function*Js(e=0){yield{type:on,siteId:e};try{const t=yield G({path:$s,method:"POST",data:{site_id:e}});return yield Zs(t),yield{type:ln,siteId:e},t}catch(e){return yield{type:cn,error:e},e}}function Zs(e){return{type:un,scan:e}}function en(e,t,r,s,n){return{type:tn,queryId:e,context:t,response:r,items:s,mode:n}}const tn="RECEIVE_QUERY",rn="START_QUERY",sn="FINISH_QUERY",nn="FAILED_QUERY",un="RECEIVE_SCAN",on="START_SCAN",ln="FINISH_SCAN",cn="FAILED_SCAN",an=(0,k.createRegistrySelector)((e=>()=>e(Ys).getQueryResults("main"))),yn=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function dn(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function gn(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:r})}function fn(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function En(e,t){return(0,w.get)(e,["queryParams",t])}function pn(e,t){return e.bySelf[t]?.item}function mn(e,t){return e.querying.includes(t)}function In(e,t=0){return e.scanning===t}function*Sn(){yield $(Ys,"query","main",{per_page:100})}const _n={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[],scanning:null},hn=(0,k.createReduxStore)(Ys,{actions:I,selectors:S,resolvers:_,controls:ee,reducer:function(e=_n,t){switch(t.type){case tn:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))}};case rn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case sn:case nn:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case un:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.scan)]:{context:"edit",item:t.scan}}};case on:return{...e,scanning:t.siteId};case ln:case cn:return{...e,scanning:null};default:return e}}});(0,k.register)(hn);const qn=hn,Tn="ithemes-security/patchstack",vn="https://itsec-site-scanner.ithemes.com";function*An(e,t={}){let r,s;yield{type:xn,queryId:e,queryParams:t},t.per_page=t.per_page||100,t.page=t.page||1;try{if(r=yield j((0,te.addQueryArgs)(vn+"/db",t),{credentials:"omit"}),!r.ok)throw yield K(r);s=yield K(r)}catch(r){return yield{type:Un,queryId:e,queryParams:t,error:r},r}return yield Qn(e,t.context||"view",r,s,"replace"),yield{type:Ln,queryId:e,queryParams:t,response:r},r}function*Rn(e){const t=yield k.controls.select(Tn,"getQueryParams",e);yield*An(e,t)}function*bn(e,t="append"){return yield*Pn(e,"prev",t)}function*Nn(e,t="append"){return yield*Pn(e,"next",t)}function*Pn(e,t,r){const s=yield k.controls.select(Tn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:xn,queryId:e};try{n=yield j(vn+s.link,{credentials:"omit"}),i=yield K(n)}catch(t){return yield{type:Un,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield Qn(e,u,n,i,r),yield{type:Ln,queryId:e,response:n},n}function Qn(e,t,r,s,n){return{type:Dn,queryId:e,context:t,response:r,items:s,mode:n}}const xn="START_QUERY",Ln="FINISH_QUERY",Un="FAILED_QUERY",Dn="RECEIVE_QUERY",Cn=(0,k.createRegistrySelector)((e=>()=>e(Tn).getQueryResults("main")));function Fn(e,t){return e.byId[t]}const On=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"ids"],[]),s=e.byId,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.byId]));function kn(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:[r]})}function wn(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:[r]})}function Hn(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function Vn(e,t){return(0,w.get)(e,["queryParams",t])}function Bn(e,t){return kn(e,t,"next")}function Gn(e,t){return!!kn(e,t,"prev")}function Mn(e,t){return(0,w.get)(e,["errors",t])}function Yn(e,t){return e.querying.includes(t)}function*$n(){yield $(Tn,"query","main",{per_page:100})}const jn={byId:{},queries:{},queryParams:{},querying:[],actions:[]},Kn=(0,k.createReduxStore)(Tn,{controls:ee,actions:h,selectors:q,resolvers:T,reducer:function(e=jn,t){switch(t.type){case Dn:return{...e,queries:{...e.queries,[t.queryId]:{ids:"replace"===t.mode?(0,w.map)(t.items,"id"):[...(0,w.get)(e,["queries",t.queryId,"ids"],[]),...(0,w.map)(t.items,"id")],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},byId:{...e.byId,...(0,w.fromPairs)(t.items.filter((r=>{const s=r.id;return!e.byId[s]||"embed"===e.byId[s].context||e.byId[s].context===t.context})).map((e=>[e.id,{context:t.context,item:e}])))}};case xn:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},errors:(0,w.omit)(e.errors,[t.queryId])};case Ln:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case Un:return{...e,querying:e.querying.filter((e=>e!==t.queryId)),errors:{...e.errors,[t.queryId]:t.error}};default:return e}}});(0,k.register)(Kn);const Wn=Kn;var Xn=r(29672);const zn="ithemes-security/users",Jn="/wp/v2/users",Zn="/ithemes-security/v1/user-actions";function*ei(e,t={}){let r,s;yield{type:Ii,queryId:e,queryParams:t};try{r=yield G({path:(0,te.addQueryArgs)(Jn,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:_i,queryId:e,queryParams:t,error:r},r}return yield ii(e,t.context||"view",r,s,"replace"),yield{type:Si,queryId:e,queryParams:t,response:r},r}function*ti(e){const t=yield Y(zn,"getQueryParams",e);yield*ei(e,t)}function*ri(e,t="append"){return yield*ni(e,"prev",t)}function*si(e,t="append"){return yield*ni(e,"next",t)}function*ni(e,t,r){const s=yield Y(zn,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:Ii,queryId:e};try{n=yield G({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:_i,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield ii(e,u,n,i,r),yield{type:Si,queryId:e,response:n},n}function ii(e,t,r,s,n){return{type:mi,queryId:e,context:t,response:r,items:s,mode:n}}function ui(e){return{type:vi,user:e}}function*oi(e,t,r){const s=yield Y(zn,"getQueryParams",e),n=e;yield{type:hi,id:n};try{const e=yield G({path:Zn,method:"POST",data:{query:s,mode:t,actions:r}});return yield{type:qi,id:n},yield{type:Pi},yield{type:xi},yield ci(),e}catch(e){return yield{type:Ti,id:n,error:e},e}}function*li(e,t,r){yield{type:hi,id:r};try{const s=yield G({path:Zn,method:"POST",data:{users:e,actions:t}});return yield{type:qi,id:r},yield{type:Pi},yield{type:xi},yield ci(),s}catch(e){return yield{type:Ti,id:r,error:e},e}}function ci(){return k.controls.dispatch(Xn.store,"createNotice","info",(0,ot.__)("Quick edits are being applied in the background. This may take a few moments.","better-wp-security"),{id:"user_security_quick_edits_success",type:"snackbar",context:"ithemes-security"})}function*ai(e){switch(e){case"all":yield k.controls.dispatch(Xn.store,"createNotice","info",(0,ot.__)("All users from the query are selected","better-wp-security"),{id:"user_security_all_selected",type:"snackbar",context:"ithemes-security"});break;case"window":yield k.controls.dispatch(Xn.store,"createNotice","info",(0,ot.__)("Only the current page of users from the query are selected","better-wp-security"),{id:"user_security_page_selected",type:"snackbar",context:"ithemes-security"});break;case"none":yield k.controls.dispatch(Xn.store,"createNotice","info",(0,ot.__)("None of the users from the query are selected","better-wp-security"),{id:"user_security_none_selected",type:"snackbar",context:"ithemes-security"}),yield{type:xi}}yield{type:Ai,userSelectionType:e}}function yi(){return{type:bi}}function di(e){return{type:Ri,user:e}}function gi(){return{type:xi}}function fi(){return{type:Ni}}function Ei(){return{type:Pi}}function pi(){return{type:Qi}}const mi="RECEIVE_QUERY",Ii="START_QUERY",Si="FINISH_QUERY",_i="FAILED_QUERY",hi="START_ACTION",qi="FINISH_ACTION",Ti="FAILED_ACTION",vi="RECEIVE_USER",Ai="UPDATE_SELECTION_TYPE",Ri="TOGGLE_SELECTED_USER",bi="TOGGLE_SELECT_ALL",Ni="OPEN_QUICK_EDIT",Pi="CLOSE_QUICK_EDIT",Qi="CONFIRM_QUICK_EDIT",xi="REMOVE_SELECTED_USERS",Li=(0,k.createRegistrySelector)((e=>()=>e(zn).getQueryResults("main"))),Ui=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.queries[t],e.bySelf]));function Di(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Ci(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Fi(e,t){return!!Di(e,t,"prev")}function Oi(e,t){return!!Di(e,t,"next")}function ki(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function wi(e,t){return(0,w.get)(e,["queryParams",t])}function Hi(e,t){return e.bySelf[t]?.item}function Vi(e,t){return Hi(e,e.selfById[t])}function Bi(e){return e.userSelection}function Gi(e,t){return e.actions.includes(t)}function Mi(e,t){return e.actionErrors[t]}function Yi(e){return e.selectedUsers}function $i(e){const t=Ui(e,"main");return e.selectedUsers.length===t.length?"checked":e.selectedUsers.length>0?"indeterminate":"unchecked"}function ji(e,t){return e.querying.includes(t)}function Ki(e,t){return e.selectedUsers.includes(t)}function Wi(e){return e.quickEditState}function Xi(e){return e.actions}function*zi(){yield $(zn,"query","main",{per_page:20,context:"edit",roles:["administrator"]})}function*Ji(e){const t=yield G({path:`${Jn}/${e}?context=edit`});return yield ui(t),t}const Zi={bySelf:{},selfById:{},userSelection:"window",queries:{},queryParams:{},querying:[],actions:[],actionErrors:{},selectedUsers:[],quickEditState:!1},eu=(0,k.createReduxStore)(zn,{actions:v,selectors:A,resolvers:R,controls:ee,reducer:function(e=Zi,t){switch(t.type){case mi:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))},selectedUsers:"main"===t.queryId?[]:e.selectedUsers};case Ii:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case Si:case _i:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case vi:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.user)]:{context:"edit",item:t.user}},selfById:{...e.selfById,[t.user.id]:(0,B.Ng)(t.user)}};case Ai:return{...e,userSelection:t.userSelectionType};case bi:const r=Ui(e,"main");return e.selectedUsers.length===r.length?{...e,selectedUsers:[]}:{...e,selectedUsers:r.map((e=>e.id))};case Ri:return e.selectedUsers.includes(t.user.id)?{...e,selectedUsers:e.selectedUsers.filter((e=>e!==t.user.id)),userSelection:"all"}:{...e,selectedUsers:[...e.selectedUsers,t.user.id],userSelection:"window"};case xi:return{...e,selectedUsers:[],userSelection:"none"};case Ni:return{...e,quickEditState:!0};case Pi:return{...e,quickEditState:!1};case Qi:return{...e,quickEditState:"confirm"};case hi:return{...e,actions:[...e.actions,t.id],actionErrors:(0,w.omit)(e.actionErrors,t.id)};case qi:return{...e,actions:e.actions.filter((e=>e!==t.id))};case Ti:return{...e,actions:e.actions.filter((e=>e!==t.id)),actionErrors:{...e.actionErrors,[t.id]:t.error}};default:return e}}});(0,k.register)(eu);const tu=eu,ru="ithemes-security/firewall",su="/ithemes-security/v1/firewall/rules",nu=(e,t={})=>async({dispatch:r})=>{let s,n;r({type:Iu,queryId:e,queryParams:t});try{s=await V()({path:(0,te.addQueryArgs)(su,t),parse:!1}),n=await s.json()}catch(s){return r({type:_u,queryId:e,queryParams:t,error:s}),s}return r(Eu(e,t.context||"view",s,n,"replace")),r({type:Su,queryId:e,queryParams:t,response:s}),n},iu=e=>async({select:t,dispatch:r})=>{const s=t.getQueryParams(e);r.query(e,s)},uu=(e,t="append")=>(...r)=>lu(e,"prev",t)(...r),ou=(e,t="append")=>(...r)=>lu(e,"next",t)(...r),lu=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:Iu,queryId:e});try{u=await V()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:_u,queryId:e,error:t}),t}const l=(0,te.getQueryArg)(i.link,"context")||"view";return n(Eu(e,l,u,o,r)),n({type:Su,queryId:e,response:u}),u},cu=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,w.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function au(e){return{type:"RESET_EDITS",self:e}}function yu(){return{type:"RESET_ALL_EDITS"}}const du=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(au(e)),n},gu=e=>async({dispatch:t})=>{const r=(0,B.Ng)(e);r&&t({type:"START_SAVING",self:r});try{const s=await V()({url:r,path:!r&&su,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}},fu=e=>async({dispatch:t})=>{t({type:"START_DELETING",self:e});try{await V()({url:e,method:"DELETE"}),t({type:"FINISH_DELETING",self:e})}catch(r){t({type:"FAILED_DELETING",self:e,error:r})}};function Eu(e,t,r,s,n){return{type:pu,queryId:e,context:t,response:r,items:s,mode:n}}const pu="RECEIVE_QUERY",mu="RECEIVE_ITEM",Iu="START_QUERY",Su="FINISH_QUERY",_u="FAILED_QUERY",hu=(0,k.createRegistrySelector)((e=>()=>e(ru).getQueryResults("main"))),qu=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function Tu(e,t,r){return(0,w.find)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function vu(e,t,r){return(0,w.filter)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Au(e,t){return!!Tu(e,t,"prev")}function Ru(e,t){return!!Tu(e,t,"next")}function bu(e,t,r){return(0,w.get)(e,["query","queries",t,"headers",r])}function Nu(e,t){return(0,w.get)(e,["query","queryParams",t])}function Pu(e,t){return e.query.bySelf[t]?.item}function Qu(e,t){return Pu(e,e.query.selfById[t])}function xu(e,t){return e.query.querying.includes(t)}const Lu=(0,De.A)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]]));function Uu(e,t){return void 0!==e.edits.bySelf[t]}function Du(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.selves.includes(r)}function Cu(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.deleting.selves.includes(r)}function Fu(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.errors[r]}function Ou(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.deleting.errors[r]}const ku=()=>async({dispatch:e})=>{await e.query("main",{per_page:100,paused:"false"})},wu={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await V()({url:(0,te.addQueryArgs)(e,{context:"edit"})})})},isFulfilled:(e,t)=>"edit"===e.query.bySelf[t]?.context},Hu={fulfill:e=>async({dispatch:t})=>{t({type:"RECEIVE_ITEM",item:await V()({path:`${su}/${e}?context=edit`})})},isFulfilled:(e,t)=>!!e.query.selfById[t]},Vu={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},Bu={bySelf:{}},Gu={selves:[],errors:{}},Mu=(0,k.combineReducers)({query:function(e=Vu,t){switch(t.type){case pu:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case Iu:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case Su:case _u:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case mu:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,B.Ng)(t.item)}};case"FINISH_DELETING":return{...e,bySelf:(0,w.omit)(e.bySelf,t.self),selfById:(0,w.omitBy)(e.selfById,(e=>e===t.self))};default:return e}},edits:function(e=Bu,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":case"FINISH_DELETING":return{...e,bySelf:(0,w.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=Gu,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,w.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}},deleting:function(e=Gu,t){switch(t.type){case"START_DELETING":return{...e,selves:[...e.selves,t.self],errors:(0,w.omit)(e.errors,t.self)};case"FINISH_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_DELETING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),Yu=(0,k.createReduxStore)(ru,{actions:b,selectors:N,resolvers:P,reducer:Mu,controls:ee});(0,k.register)(Yu);const $u=Yu,ju="ithemes-security/logs",Ku="/ithemes-security/v1/logs";function*Wu(e,t={}){let r,s;yield{type:so,queryId:e,queryParams:t};try{r=yield G({path:(0,te.addQueryArgs)(Ku,t),parse:!1}),s=yield K(r)}catch(r){return yield{type:io,queryId:e,queryParams:t,error:r},r}return yield eo(e,t.context||"view",r,s,"replace"),yield{type:no,queryId:e,queryParams:t,response:r},s}function*Xu(e){const t=yield Y(ju,"getQueryParams",e);yield*Wu(e,t)}function*zu(e,t="append"){return yield*Zu(e,"prev",t)}function*Ju(e,t="append"){return yield*Zu(e,"next",t)}function*Zu(e,t,r){const s=yield Y(ju,"getQueryHeaderLink",e,t);if(!s)return[];let n,i;yield{type:so,queryId:e};try{n=yield G({url:s.link,parse:!1}),i=yield K(n)}catch(t){return yield{type:io,queryId:e,error:t},t}const u=(0,te.getQueryArg)(s.link,"context")||"view";return yield eo(e,u,n,i,r),yield{type:no,queryId:e,response:n},n}function eo(e,t,r,s,n){return{type:ro,queryId:e,context:t,response:r,items:s,mode:n}}function to(e){return{type:uo,log:e}}const ro="RECEIVE_QUERY",so="START_QUERY",no="FINISH_QUERY",io="FAILED_QUERY",uo="RECEIVE_LOG",oo=(0,k.createRegistrySelector)((e=>()=>e(ju).getQueryResults("main"))),lo=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["queries",t,"selves"],[]),s=e?.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e?.queries[t],e?.bySelf]));function co(e,t,r){return(0,w.find)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function ao(e,t,r){return(0,w.filter)((0,w.get)(e,["queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function yo(e,t){return!!co(e,t,"prev")}function go(e,t){return!!co(e,t,"next")}function fo(e,t,r){return(0,w.get)(e,["queries",t,"headers",r])}function Eo(e,t){return(0,w.get)(e,["queryParams",t])}function po(e,t){return e.querying.includes(t)}function mo(e,t){return e.bySelf[t]?.item}function Io(e,t){return mo(e,e.selfById[t])}function*So(){yield $(ju,"query","main",{per_page:100})}function*_o(e){const t=yield G({path:`${Ku}/${e}`});return yield to(e),t}const ho={bySelf:{},selfById:{},queries:{},queryParams:{},querying:[]},qo=(0,k.createReduxStore)(ju,{actions:Q,selectors:x,resolvers:L,controls:ee,reducer:function(e=ho,t){switch(t.type){case ro:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case so:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case no:case io:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case uo:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.log)]:{context:"edit",item:t.log}},selfById:{...e.selfById,[t.log.id]:(0,B.Ng)(t.log)}};default:return e}}});(0,k.register)(qo);const To=qo,vo="/ithemes-security/v1/trusted-devices",Ao=(e,t,r={})=>async({dispatch:s})=>{let n,i;s({type:wo,queryId:e,userId:t,queryParams:r});try{n=await V()({path:(0,te.addQueryArgs)(vo+"/"+t,r),parse:!1}),i=await n.json()}catch(t){return s({type:Vo,queryId:e,queryParams:r,error:t}),t}return s(Fo(e,r.context||"view",n,i,"replace")),s({type:Ho,queryId:e,queryParams:r,response:n}),i},Ro=e=>async({select:t,dispatch:r})=>{const s=t.getQueryUser(e),n=t.getQueryParams(e);r.query(e,s,n)},bo=(e,t="append")=>(...r)=>Po(e,"prev",t)(...r),No=(e,t="append")=>(...r)=>Po(e,"next",t)(...r),Po=(e,t,r)=>async({select:s,dispatch:n})=>{const i=s.getQueryHeaderLink(e,t);if(!i)return[];let u,o;n({type:wo,queryId:e});try{u=await V()({url:i.link,parse:!1}),o=await u.json()}catch(t){return n({type:Vo,queryId:e,error:t}),t}const l=(0,te.getQueryArg)(i.link,"context")||"view";return n(Fo(e,l,u,o,r)),n({type:Ho,queryId:e,response:u}),u},Qo=(e,t)=>async({select:r,dispatch:s})=>{const n=r.getItem(e),i=r.getEditedItem(e);(0,w.isEqual)(n,{...i,...t})?s({type:"RESET_EDITS",self:e}):s({type:"EDIT_ITEM",self:e,edit:t})};function xo(e){return{type:"RESET_EDITS",self:e}}function Lo(){return{type:"RESET_ALL_EDITS"}}const Uo=e=>async({select:t,dispatch:r})=>{const s=t.getEditedItem(e);if(!s||!t.isDirty(e))return s;const n=await r.saveItem(s);return r(xo(e)),n},Do=(e=!0)=>async({dispatch:t,registry:r,select:s})=>{!0===e&&(e=s.getDirtyItems());const n=e.map((e=>({method:"PUT",path:(0,B._t)(e),body:s.getEditedItem(e)})));e.forEach((e=>t({type:"START_SAVING",self:e})));const i=await async function(e,t){const r=await e.resolveSelect(Mt).getBatchMaxItems(),s=(0,w.chunk)(t,r||25),n=[];if(!s.length)return[];for(const e of s)try{const t=await V()({path:"/batch/v1",method:"POST",data:{requests:e}});n.push(...t.responses)}catch(t){n.push(...(0,w.times)(e.length,(0,w.constant)({body:t,status:500,headers:{}})))}return n}(r,n);for(let r=0;r<n.length;r++){const s=e[r],n=i[r];n.status>=400?t({type:"FAILED_SAVING",self:s,error:n.body}):(t({type:"FINISH_SAVING",self:s}),t({type:ko,item:n.body}))}return i},Co=e=>async({dispatch:t})=>{const r=(0,B.Ng)(e);r&&t({type:"START_SAVING",self:r});try{const s=await V()({url:r,path:!r&&vo,method:r?"PUT":"POST",data:e});return t({type:"RECEIVE_ITEM",item:s}),r&&t({type:"FINISH_SAVING",self:r}),s}catch(e){throw r&&t({type:"FAILED_SAVING",self:r,error:e}),e}};function Fo(e,t,r,s,n){return{type:Oo,queryId:e,context:t,response:r,items:s,mode:n}}const Oo="RECEIVE_QUERY",ko="RECEIVE_ITEM",wo="START_QUERY",Ho="FINISH_QUERY",Vo="FAILED_QUERY",Bo=(0,De.A)(((e,t)=>{const r=(0,w.get)(e,["query","queries",t,"selves"],[]),s=e.query.bySelf,n=r.length,i=new Array(n);let u=-1;for(;++u<n;){const e=s[r[u]];e&&(i[u]=e.item)}return i}),((e,t)=>[e.query.queries[t],e.query.bySelf]));function Go(e,t,r){return(0,w.find)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Mo(e,t,r){return(0,w.filter)((0,w.get)(e,["query","queries",t,"links"],[]),{rel:(0,w.castArray)(r)})}function Yo(e,t){return!!Go(e,t,"prev")}function $o(e,t){return!!Go(e,t,"next")}function jo(e,t,r){return(0,w.get)(e,["query","queries",t,"headers",r])}function Ko(e,t){return(0,w.get)(e,["query","queryParams",t])}function Wo(e,t){return(0,w.get)(e,["query","users",t])}function Xo(e,t){return e.query.bySelf[t]?.item}function zo(e,t){return Xo(e,e.query.selfById[t])}function Jo(e,t){return e.query.querying.includes(t)}const Zo=(0,De.A)(((e,t)=>e.query.bySelf[t]?.item&&{...e.query.bySelf[t].item,...e.edits.bySelf[t]||{}}),((e,t)=>[e.edits.bySelf[t],e.query.bySelf[t]])),el=(0,De.A)((e=>(0,w.reduce)(e.edits.bySelf,((e,t,r)=>((0,w.isEmpty)(t)||e.push(r),e)),[])),(e=>[e.edits]));function tl(e,t){return void 0!==e.edits.bySelf[t]}function rl(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.selves.includes(r)}function sl(e){return e.saving.selves.length>0}function nl(e,t){const r="string"==typeof t?t:(0,B.Ng)(t);return e.saving.errors[r]}const il={bySelf:{},selfById:{},queries:{},queryParams:{},users:{},querying:[]},ul={bySelf:{}},ol={selves:[],errors:{}},ll=(0,k.combineReducers)({query:function(e=il,t){switch(t.type){case Oo:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,w.map)(t.items,B.Ng):[...(0,w.get)(e,["queries",t.queryId,"selves"],[]),...(0,w.map)(t.items,B.Ng)],headers:(0,w.fromPairs)(Array.from(t.response.headers.entries())),links:(0,$e.parse)(t.response.headers.get("link"),{extended:!0})}},bySelf:{...e.bySelf,...(0,w.fromPairs)(t.items.filter((r=>{const s=(0,B.Ng)(r);return!e.bySelf[s]||"embed"===e.bySelf[s].context||e.bySelf[s].context===t.context})).map((e=>[(0,B.Ng)(e),{context:t.context,item:e}])))},selfById:{...e.selfById,...(0,w.fromPairs)(t.items.map((e=>[e.id,(0,B.Ng)(e)])))}};case wo:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]},users:{...e.users,[t.queryId]:t.userId}};case Ho:case Vo:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case ko:return{...e,bySelf:{...e.bySelf,[(0,B.Ng)(t.item)]:{context:"edit",item:t.item}},selfById:{...e.selfById,[t.item.id]:(0,B.Ng)(t.item)}};default:return e}},edits:function(e=ul,t){switch(t.type){case"EDIT_ITEM":return{...e,bySelf:{...e.bySelf,[t.self]:{...e.bySelf[t.self]||{},...t.edit}}};case"RESET_EDITS":return{...e,bySelf:(0,w.omit)(e.bySelf,t.self)};case"RESET_ALL_EDITS":return{...e,bySelf:{}};default:return e}},saving:function(e=ol,t){switch(t.type){case"START_SAVING":return{...e,selves:[...e.selves,t.self],errors:(0,w.omit)(e.errors,t.self)};case"FINISH_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e))};case"FAILED_SAVING":return{...e,selves:e.selves.filter((e=>t.self!==e)),errors:{...e.errors,[t.self]:t.error}};default:return e}}}),cl=(0,k.createReduxStore)("ithemes-security/trusted-devices",{actions:U,selectors:D,reducer:ll,controls:ee});(0,k.register)(cl);const al=cl,yl=(0,De.A)(((e,t)=>e.users.optimisticEdits[t]?(0,w.merge)((0,w.cloneDeep)(e.users.byId[t]),e.users.optimisticEdits[t]):e.users.byId[t]),((e,t)=>[e.users.byId[t],e.users.optimisticEdits[t]]));function dl(e){return yl(e,gl(e))}function gl(e){return e.users.currentId}function fl(e,t){return e.users.saving.includes(t)}function El(e){return fl(e,e.users.currentId)}function pl(e){return e.index}function ml(e,t){const r=e.index;return r?(0,w.find)(r.routes,(e=>e?.schema?.title===t))?.schema:null}function Il(e){return e.index?.roles||null}function Sl(e){return e.index?.requirements_info||null}function _l(e){return e.actors.types}function hl(e,t){return e.actors.byType[t]}function ql(e){return e.siteInfo}const Tl=(0,k.createRegistrySelector)((e=>t=>e(lt).getSetting("feature-flags","enabled")||t.featureFlags));function vl(e){return e.batchMaxItems}function Al(e){return e.index?.server_type||null}function Rl(e){return e.index?.install_type||null}function bl(e){return e.index?.has_patchstack||null}function Nl(e){return e.index?.is_lw_customer||null}function*Pl(e=!1){let t="/ithemes-security/v1?context=help";e&&(t+="&_="+Date.now());const r=yield G({path:t});return yield Ql(r),r}function Ql(e){return{type:Vl,index:e}}function*xl(e,t=!1){yield*Ll("me",e,t)}function*Ll(e,t,r=!1){const s=yield Y("ithemes-security/core","getCurrentUserId");"me"===e&&(e=s);const n=`/wp/v2/users/${e===s?"me":e}`;yield{type:"START_SAVING_USER",id:e,data:t,optimistic:r};try{const r=yield G({method:"PUT",path:n,data:t});yield Dl(r),yield{type:"FINISH_SAVING_USER",id:e,user:r}}catch(t){yield{type:"FAILED_SAVING_USER",id:e,error:t}}}function*Ul(e){const t=yield Y("ithemes-security/core","getCurrentUserId"),r=yield G({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Dl(r)}function Dl(e){return{type:Bl,user:e}}function Cl(e){return{type:Gl,userId:e}}function Fl(e){return{type:Ml,types:e}}function Ol(e,t){return{type:Yl,actorType:e,actors:t}}function kl(e){return{type:$l,siteInfo:e}}function wl(e){return{type:jl,flags:e}}function Hl(e){return{type:Kl,maxItems:e}}const Vl="RECEIVE_INDEX",Bl="RECEIVE_USER",Gl="RECEIVE_CURRENT_USER_ID",Ml="RECEIVE_ACTOR_TYPES",Yl="RECEIVE_ACTORS",$l="RECEIVE_SITE_INFO",jl="LOAD_INITIAL_FEATURE_FLAGS",Kl="RECEIVE_BATCH_MAX_ITEMS";function*Wl(){const e=yield G({path:"/ithemes-security/v1?context=help"});yield Ql(e)}const Xl=()=>({resolveSelect:e})=>e.getIndex(),zl=()=>({resolveSelect:e})=>e.getIndex(),Jl=()=>({resolveSelect:e})=>e.getIndex(),Zl=()=>({resolveSelect:e})=>e.getIndex(),ec=()=>({resolveSelect:e})=>e.getIndex(),tc=()=>({resolveSelect:e})=>e.getIndex(),rc=()=>({resolveSelect:e})=>e.getIndex(),sc={*fulfill(e){const t=yield k.controls.select("ithemes-security/core","getCurrentUserId"),r=yield G({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield Dl(r)},isFulfilled:(e,t)=>!!e.users.byId[t]},nc={*fulfill(){const e=yield G({path:"/wp/v2/users/me?context=edit"});yield Dl(e),yield Cl(e.id)},isFulfilled:e=>e.users.currentId&&e.users.byId[e.users.currentId]},ic={*fulfill(){const e=yield G({path:"/ithemes-security/v1/actors?_embed=1"}),t=[];for(const r of e){const e=(0,w.get)(r,["_embedded","wp:items",0],[]);yield Ol(r.slug,e),t.push({slug:r.slug,label:r.label})}yield Fl(t)},isFulfilled:e=>e.actors.types.length>0},uc={*fulfill(){yield k.controls.select("ithemes-security/core","getActorTypes")},isFulfilled:(e,t)=>!!e.actors.byType[t]},oc={*fulfill(){const e=yield G({path:"/?_fields=name,description,url,home,multisite"});yield kl(e)},isFulfilled:e=>!!e.siteInfo};function*lc(){const e=yield G({path:"/batch/v1",method:"OPTIONS"});yield Hl(e.endpoints[0].args.requests.maxItems)}const cc={users:{currentId:0,byId:{},saving:[],optimisticEdits:{}},index:null,actors:{types:[],byType:{}},siteInfo:null,featureFlags:[],batchMaxItems:0};r.p=window.itsecWebpackPublicPath;const ac=(0,k.createReduxStore)(Mt,{controls:ee,selectors:C,resolvers:O,actions:F,reducer:function(e=cc,t){switch(t.type){case Vl:return{...e,index:t.index};case"START_SAVING_USER":return{...e,users:{...e.users,saving:[...e.users.saving,t.id],optimisticEdits:t.optimistic?{...e.users.optimisticEdits,[t.id]:t.data}:e.users.optimisticEdits}};case"FINISH_SAVING_USER":case"FAILED_SAVING_USER":return{...e,users:{...e.users,saving:e.users.saving.filter((e=>e!==t.id)),optimisticEdits:(0,w.omit)(e.users.optimisticEdits,t.id)}};case Bl:return{...e,users:{...e.users,byId:{...e.users.byId,[t.user.id]:t.user}}};case Gl:return{...e,users:{...e.users,currentId:t.userId}};case Ml:return{...e,actors:{...e.actors,types:t.types}};case Yl:return{...e,actors:{...e.actors,byType:{...e.actors.byType,[t.actorType]:t.actors}}};case $l:return{...e,siteInfo:t.siteInfo};case jl:return{...e,featureFlags:t.flags};case Kl:return{...e,batchMaxItems:t.maxItems};default:return e}}});(0,k.register)(ac)}},e=>{e.O(0,[222,7098,2932],(()=>e(e.s=96691)));var t=e.O();((window.itsec=window.itsec||{}).packages=window.itsec.packages||{}).data=t}]);