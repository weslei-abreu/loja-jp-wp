/*! For license information please see active-lockouts.js.LICENSE.txt */
(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[7802],{3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},10424:e=>{e.exports=function(){return this.itsec.dashboard.dashboard}()},31987:e=>{e.exports=function(){return this.wp.data}()},37398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ActiveLockout:()=>y,ActiveLockoutActions:()=>c,Detail:()=>v,List:()=>E,Search:()=>x,useActiveLockouts:()=>O,useBanLockout:()=>I,useReleaseLockout:()=>D});var n=r(51609),i=r(39959),o=r(3075),s=r(52238),a=r(10424);function c({isReleaseAvailable:e,selectedId:t,releasingIds:r,onRelease:c,isBannable:l,banningIds:u,onBan:d}){return(0,n.createElement)(a.CardFooter,null,(0,n.createElement)(s.g8,null),e&&(0,n.createElement)("span",null,(0,n.createElement)(i.Button,{variant:"primary","aria-disabled":r.includes(t),isBusy:r.includes(t),onClick:c},(0,o.__)("Release Lockout","better-wp-security"))),l&&(0,n.createElement)("span",null,(0,n.createElement)(i.Button,{variant:"primary","aria-disabled":u.includes(t),isBusy:u.includes(t),onClick:d},(0,o.__)("Ban","better-wp-security"))))}var l=r(88356),u=r(8601),d=r(89959),h=r(98883),f=r(81923);const m=(0,f.A)("div",{target:"e19hifs12"})({name:"wp0fdl",styles:"padding:0.5rem 1.25rem"}),p=(0,f.A)("li",{target:"e19hifs11"})({name:"a0377c",styles:"display:flex;align-items:center;gap:0.75rem"}),g=(0,f.A)(l.EY,{target:"e19hifs10"})("background-color:",(({theme:e})=>e.colors.surface.secondary),";padding:11px 6px;border-radius:2px;");function v({master:e={},isVisible:t,fetchLockoutDetails:r}){const i=(0,u.useMemo)((()=>e),[e]),o=(0,u.useCallback)((()=>r(e)),[r,e]),{value:s}=(0,h.Yb)(o,t);return(0,n.createElement)(m,null,(0,n.createElement)(y,{master:i}),s&&s.history.length>0&&(0,n.createElement)(w,{history:s.history}))}function y({master:e={}}){return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(i.Tooltip,{text:(0,d.dateI18n)("M d, Y g:s A",e.start_gmt)},(0,n.createElement)("span",null,(0,n.createElement)(l.EY,{as:"time",size:l.$C.SMALL,textTransform:"capitalize",variant:l.J3.MUTED,text:(0,o.sprintf)((0,o.__)("%s ago","better-wp-security"),e.start_gmt_relative)}))),(0,n.createElement)(l.DZ,{level:3,size:l.$C.NORMAL,variant:l.J3.DARK,weight:l.uL.HEAVY,text:e.label}),(0,n.createElement)(l.EY,{variant:l.J3.DARK,text:e.description}))}function w({history:e}){return(0,n.createElement)(React.Fragment,null,(0,n.createElement)("hr",null),(0,n.createElement)("div",null,(0,n.createElement)(l.DZ,{level:4,size:l.$C.NORMAL,variant:l.J3.DARK,weight:l.uL.HEAVY,text:(0,o.__)("History","better-wp-security")}),(0,n.createElement)("ul",null,e.map((e=>(0,n.createElement)(b,{key:e.id,history:e}))))))}function b({history:e}){if(e.label)return(0,n.createElement)(p,{key:e.id},(0,n.createElement)(g,{as:"code"},e.label),(0,n.createElement)(i.Tooltip,{text:(0,d.dateI18n)("M d, Y g:s A",e.time)},(0,n.createElement)("span",null," ","â€¢"," ",(0,n.createElement)(l.EY,{as:"time",variant:l.J3.DARK,text:(0,o.sprintf)((0,o.__)("%s ago","better-wp-security"),e.time_relative)}))))}function E({lockouts:e,select:t,selectedLockout:r,fetchLockoutDetails:i}){return(0,n.createElement)(l.qj,{masters:e,getId:e=>e.id,isBorderless:!0,isSinglePane:!0,mode:"list",renderMaster:e=>(0,n.createElement)(y,{master:e}),onSelect:t,selectedId:r?.id||0,renderDetail:(e,t)=>(0,n.createElement)(v,{master:e,isVisible:t,fetchLockoutDetails:i})})}const k=(0,f.A)("div",{target:"e1i4g2bk0"})({name:"1dvcxr3",styles:"padding:1rem"});function x({searchTerm:e,setSearchTerm:t,isQuerying:r,query:i,queryId:s}){return(0,n.createElement)(k,null,(0,n.createElement)(l.qz,{placeholder:(0,o.__)("Search Lockouts","better-wp-security"),value:e,onChange:e=>{t(e),i(s,e?{search:e}:{})},isSearching:r,size:"small"}))}var L=r(31987),_=r(85631),A=r.n(_);function I(e){const[t,r]=(0,u.useState)([]),{createNotice:n,removeNotice:i}=(0,L.useDispatch)("core/notices"),s=e._links["ithemes-security:ban-lockout"]?.[0].href,a=!!s;return[t,(0,u.useCallback)((async e=>{const t=s.replace("{lockout_id}",e),a=`ban-lockout-${t}`;r((t=>[...t,e])),i(a,"ithemes-security");try{return await A()({url:t,method:"POST"}),setTimeout((()=>i(a,"ithemes-security")),5e3),n("success",(0,o.__)("Ban Created","better-wp-security"),{id:a,context:"ithemes-security"}),!0}catch(e){return n("error",(0,o.sprintf)((0,o.__)("Error when banning lockout: %s","better-wp-security"),e.message||(0,o.__)("An unexpected error occurred.","better-wp-security")),{id:a,context:"ithemes-security"}),!1}finally{r((t=>t.filter((t=>t!==e))))}}),[s,n,i]),a]}function D(e){const[t,r]=(0,u.useState)([]),{createNotice:n,removeNotice:i}=(0,L.useDispatch)("core/notices"),s=e._links["ithemes-security:release-lockout"]?.[0].href,a=!!s;return[t,(0,u.useCallback)((async e=>{const t=s.replace("{lockout_id}",e),a=`release-lockout-${t}`;r((t=>[...t,e])),i(a,"ithemes-security");try{return await A()({url:t,method:"DELETE"}),setTimeout((()=>i(a,"ithemes-security")),5e3),n("success",(0,o.__)("Lockout Released","better-wp-security"),{id:a,context:"ithemes-security"}),!0}catch(e){return n("error",(0,o.sprintf)((0,o.__)("Error when releasing lockout: %s","better-wp-security"),e.message||(0,o.__)("An unexpected error occurred.","better-wp-security")),{id:a,context:"ithemes-security"}),!1}finally{r((t=>t.filter((t=>t!==e))))}}),[s,n,i]),a]}function O(e){const[t,r]=(0,u.useState)(0),[n,i]=(0,u.useState)(""),[o,s,a]=I(e),[c,l,d]=D(e),h=(0,u.useCallback)((e=>{if(!e.links.item)return Promise.reject(new Error("No data available."));const t=e.links.item[0].href.replace("{lockout_id}",e.id);return A()({url:t}).then((e=>e.detail))}),[]),{isQuerying:f}=(0,L.useSelect)((t=>({isQuerying:t("ithemes-security/dashboard").isQueryingDashboardCard(e.id)})),[e.id]),{queryDashboardCard:m,refreshDashboardCard:p}=(0,L.useDispatch)("ithemes-security/dashboard");return{selectedId:t,searchTerm:n,setSearchTerm:i,isQuerying:f,query:m,select:e=>r(e),getDetails:h,onBan:async n=>{n.preventDefault();const i=await s(t);await p(e.id),i&&r((e=>e===t?0:e))},onRelease:async n=>{n.preventDefault();const i=await l(t);await p(e.id),i&&r((e=>e===t?0:e))},isBanAvailable:a,isReleaseAvailable:d,releasingIds:c,banningIds:o}}r.p=window.itsecWebpackPublicPath},39959:e=>{e.exports=function(){return this.wp.components}()},46627:e=>{e.exports=function(){return this.itsec.packages.data}()},46942:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=s(e,o(r)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=s(t,r));return t}function s(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},51609:e=>{"use strict";e.exports=window.React},55933:e=>{e.exports=function(){return this.wp.primitives}()},57677:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(8601);const i=(0,n.forwardRef)((function({icon:e,size:t=24,...r},i){return(0,n.cloneElement)(e,{width:t,height:t,...r,ref:i})}))},62247:e=>{e.exports=function(){return this.wp.isShallowEqual}()},66087:e=>{"use strict";e.exports=window.lodash},70404:(e,t,r)=>{"use strict";function n(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function i(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function o(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var r=getComputedStyle(e,null);return i(r.overflowY,t)||i(r.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function s(e,t,r,n,i,o,s,a){return o<e&&s>t||o>e&&s<t?0:o<=e&&a<=r||s>=t&&a>=r?o-e-n:s>t&&a<r||o<e&&a>r?s-t+i:0}r.d(t,{A:()=>l});var a=function(e,t){var r=window,i=t.scrollMode,a=t.block,c=t.inline,l=t.boundary,u=t.skipOverflowHiddenElements,d="function"==typeof l?l:function(e){return e!==l};if(!n(e))throw new TypeError("Invalid target");for(var h,f,m=document.scrollingElement||document.documentElement,p=[],g=e;n(g)&&d(g);){if((g=null==(f=(h=g).parentElement)?h.getRootNode().host||null:f)===m){p.push(g);break}null!=g&&g===document.body&&o(g)&&!o(document.documentElement)||null!=g&&o(g,u)&&p.push(g)}for(var v=r.visualViewport?r.visualViewport.width:innerWidth,y=r.visualViewport?r.visualViewport.height:innerHeight,w=window.scrollX||pageXOffset,b=window.scrollY||pageYOffset,E=e.getBoundingClientRect(),k=E.height,x=E.width,L=E.top,_=E.right,A=E.bottom,I=E.left,D="start"===a||"nearest"===a?L:"end"===a?A:L+k/2,O="center"===c?I+x/2:"end"===c?_:I,S=[],R=0;R<p.length;R++){var C=p[R],N=C.getBoundingClientRect(),T=N.height,W=N.width,B=N.top,H=N.right,M=N.bottom,V=N.left;if("if-needed"===i&&L>=0&&I>=0&&A<=y&&_<=v&&L>=B&&A<=M&&I>=V&&_<=H)return S;var Y=getComputedStyle(C),P=parseInt(Y.borderLeftWidth,10),z=parseInt(Y.borderTopWidth,10),j=parseInt(Y.borderRightWidth,10),q=parseInt(Y.borderBottomWidth,10),J=0,Q=0,$="offsetWidth"in C?C.offsetWidth-C.clientWidth-P-j:0,F="offsetHeight"in C?C.offsetHeight-C.clientHeight-z-q:0,K="offsetWidth"in C?0===C.offsetWidth?0:W/C.offsetWidth:0,X="offsetHeight"in C?0===C.offsetHeight?0:T/C.offsetHeight:0;if(m===C)J="start"===a?D:"end"===a?D-y:"nearest"===a?s(b,b+y,y,z,q,b+D,b+D+k,k):D-y/2,Q="start"===c?O:"center"===c?O-v/2:"end"===c?O-v:s(w,w+v,v,P,j,w+O,w+O+x,x),J=Math.max(0,J+b),Q=Math.max(0,Q+w);else{J="start"===a?D-B-z:"end"===a?D-M+q+F:"nearest"===a?s(B,M,T,z,q+F,D,D+k,k):D-(B+T/2)+F/2,Q="start"===c?O-V-P:"center"===c?O-(V+W/2)+$/2:"end"===c?O-H+j+$:s(V,H,W,P,j+$,O,O+x,x);var Z=C.scrollLeft,G=C.scrollTop;D+=G-(J=Math.max(0,Math.min(G+J/X,C.scrollHeight-T/X+F))),O+=Z-(Q=Math.max(0,Math.min(Z+Q/K,C.scrollWidth-W/K+$)))}S.push({el:C,top:J,left:Q})}return S};function c(e){return e===Object(e)&&0!==Object.keys(e).length}const l=function(e,t){var r=e.isConnected||e.ownerDocument.documentElement.contains(e);if(c(t)&&"function"==typeof t.behavior)return t.behavior(r?a(e,t):[]);if(r){var n=function(e){return!1===e?{block:"end",inline:"nearest"}:c(e)?e:{block:"start",inline:"nearest"}}(t);return function(e,t){void 0===t&&(t="auto");var r="scrollBehavior"in document.body.style;e.forEach((function(e){var n=e.el,i=e.top,o=e.left;n.scroll&&r?n.scroll({top:i,left:o,behavior:t}):(n.scrollTop=i,n.scrollLeft=o)}))}(a(e,n),n.behavior)}}},74596:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(51609),i=r(55933);const o=(0,n.createElement)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,n.createElement)(i.Path,{d:"M7 11.5h10V13H7z"}))},77172:e=>{e.exports=function(){return this.wp.url}()},79860:e=>{e.exports=function(){return this.wp.keycodes}()},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},89897:e=>{e.exports=function(){return this.wp.compose}()},89959:e=>{e.exports=function(){return this.wp.date}()}},e=>{e.O(0,[9427,8356,222,3733,1588,2932,2238],(()=>e(e.s=37398)));var t=e.O();((window.itsec=window.itsec||{}).core=window.itsec.core||{})["active-lockouts"]=t}]);