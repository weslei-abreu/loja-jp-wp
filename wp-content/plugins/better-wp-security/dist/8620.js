"use strict";(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[8620],{48620:(e,t,a)=>{a.d(t,{i$:()=>xe,DW:()=>F,qJ:()=>z,n_:()=>ge,F5:()=>p,VS:()=>f,g8:()=>v,zf:()=>ee,gu:()=>oe,VK:()=>I,G9:()=>Z,oA:()=>Ne,l6:()=>M,pe:()=>Q,PB:()=>U,Nr:()=>G,Fe:()=>_e,UZ:()=>Ce});var n=a(51609),r=a(64827),o=a(66087),l=a(8601),s=a(85631),i=a.n(s),c=a(77172),d=a(39959),m=a(89897);const{useGlobalState:u}=(0,r.VB)({cache:{}});function p({id:e,value:t,disabled:a,readonly:r,onChange:s,label:h,description:g,isMultiple:f=!1,path:b,query:E={},labelAttr:v,idAttr:y="id",searchArg:x="search"}){const[_,A]=u("cache"),N=(0,m.useInstanceId)(p,"itsec-entity-select-control");e=e||N;const[C,k]=(0,l.useState)(""),w=function(e,t,a,n,r,s,d){return(0,l.useCallback)((l=>i()({path:(0,c.addQueryArgs)(e,{...t,[r]:l})}).then((e=>e.map((e=>({value:e[n],label:e[a]}))))).then((t=>(d({...s,[e]:{...s[e]||{},...(0,o.mapValues)((0,o.keyBy)(t,"value"),"label")}}),t)))),[e,t,a,n,r,s,d])}(b,E,v,y,x,_,A);let S;return f?S=(t||[]).filter((e=>void 0!==e)).map((e=>({value:e,label:_[b]?.[e]||e}))):t&&(S={value:t,label:_[b]?.[t]||t}),(0,n.createElement)(d.BaseControl,{className:"itsec-entity-select-control",label:h,help:g&&(0,n.createElement)(I,{noWrap:!0,content:g}),id:e,__nextHasNoMarginBottom:!0},(0,n.createElement)(F,{"aria-label":h,"aria-describedby":g?e+"__help":void 0,classNamePrefix:"itsec-entity-select-control-as",inputId:e,isDisabled:a||r,isMulti:f,isClearable:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:w,value:S,onChange:e=>s(f?(e||[]).map((e=>e.value)):e?.value),inputValue:C,onInputChange:k}))}var h=a(88356),g=a(62932);function f({errors:e,apiError:t,schemaError:a,title:r,className:o,hasBorder:l}){const s=[...e||[],...(0,g.Mr)(t),...(a||[]).map((e=>e.stack))];return s.length?(0,n.createElement)(h.Mf,{messages:s,heading:r,className:o,hasBorder:l,type:"danger"}):null}var b=a(81923);const E=(0,b.A)("div",{target:"eq12dkg0"})({name:"1ff36h2",styles:"flex-grow:1"});function v(){return(0,n.createElement)(E,{"aria-hidden":!0})}var y=a(58168),x=a(15013),_=a(54625);function I({transform:e,...t}){return(0,n.createElement)(x.VK,(0,y.A)({},t,{transform:(a,r)=>{if(e){const t=e(a,r);if(void 0!==t)return t}if("a"===a.tagName.toLowerCase()&&a.dataset.itsecPath&&!t.noHtml)return(0,n.createElement)(_.N_,{to:a.dataset.itsecPath},r)}}))}var A=a(2359),N=a(79487),C=a(32196),k=a(3075);const w=(0,n.lazy)((()=>Promise.all([a.e(7853),a.e(6005)]).then(a.bind(a,46005)))),S=(0,n.lazy)((()=>Promise.all([a.e(7853),a.e(1541)]).then(a.bind(a,11541)))),O=(0,n.lazy)((()=>Promise.all([a.e(7853),a.e(3689)]).then(a.bind(a,23689))));function T(){return(0,n.createElement)("span",null,(0,k.__)("Error when loading. Please refresh.","better-wp-security"))}const L=(0,C.AH)({name:"1nml846",styles:"input{min-height:0;}input:focus{box-shadow:none;}"});function P(){const e=(0,N.u)();return(0,l.useCallback)((t=>({...t,colors:{...t.colors,primary:e.colors.primary.base,primary75:e.colors.secondary.base,primary50:e.colors.tertiary.base,primary25:e.colors.surface.secondary}})),[e])}function D(){return(0,l.useMemo)((()=>({control:(e,t)=>({...e,minHeight:36,borderColor:t.isFocused?e.borderColor:"rgb(148, 148, 148)",borderRadius:2}),dropdownIndicator:e=>({...e,padding:6}),clearIndicator:e=>({...e,padding:6}),loadingIndicator:e=>({...e,padding:6}),valueContainer:e=>({...e,paddingTop:0,paddingBottom:0}),input:e=>({...e,paddingTop:0,paddingBottom:0})})),[])}function M({addErrorBoundary:e=!0,className:t,...a}){const r=P(),o=D(),l=(0,n.createElement)(n.Suspense,{fallback:(0,n.createElement)(d.Spinner,null)},(0,n.createElement)(w,(0,y.A)({},a,{className:(0,C.cx)(t,L),theme:r,styles:o})));return e?(0,n.createElement)(A.ErrorBoundary,{FallbackComponent:T},l):l}function F({addErrorBoundary:e=!0,className:t,...a}){const r=P(),o=D(),l=(0,n.createElement)(n.Suspense,{fallback:(0,n.createElement)(d.Spinner,null)},(0,n.createElement)(S,(0,y.A)({},a,{className:(0,C.cx)(t,L),theme:r,styles:o})));return e?(0,n.createElement)(A.ErrorBoundary,{FallbackComponent:T},l):l}function z({addErrorBoundary:e=!0,className:t,...a}){const r=P(),o=D(),l=(0,n.createElement)(n.Suspense,{fallback:(0,n.createElement)(d.Spinner,null)},(0,n.createElement)(O,(0,y.A)({},a,{className:(0,C.cx)(t,L),theme:r,styles:o})));return e?(0,n.createElement)(A.ErrorBoundary,{FallbackComponent:T},l):l}var B=a(591),$=a(41588);const j=(0,b.A)(h.ui,{target:"ewfm7an3"})({name:"1x94tvs",styles:"display:flex;align-items:center;flex-shrink:0;padding:.5rem 1.5rem;min-height:calc(30px + 1rem);& .components-button:focus{box-shadow:none;}"}),V=(0,b.A)(d.Toolbar,{target:"ewfm7an2"})({name:"gxzf6f",styles:"border:none;max-width:100%;margin-left:auto"}),H=(0,b.A)("div",{target:"ewfm7an1"})({name:"hlx1h5",styles:"display:flex;gap:0.5rem;margin:0 2rem 0 1rem;flex-grow:1"}),R=(0,b.A)($.Ot,{target:"ewfm7an0"})({name:"1jxlbx4",styles:"height:2rem;width:2rem"});function Y({area:e,...t}){return(0,n.createElement)(d.Slot,(0,y.A)({name:`Toolbar${e}`},t))}function U({area:e="actions",...t}){return(0,n.createElement)(d.Fill,(0,y.A)({name:`Toolbar${e}`},t))}function G(){const e=(0,g.aZ)("dashboard"),t=(0,m.useViewportMatch)("medium","<");return(0,n.createElement)(j,{role:"region","aria-label":(0,k.__)("Toolbar","better-wp-security")},t?(0,n.createElement)(R,null):(0,n.createElement)(oe,null),(0,n.createElement)(Y,{area:"main"},(e=>(0,n.createElement)(H,null,e))),(0,n.createElement)(V,{label:(0,k.__)("Toolbar Actions","better-wp-security")},(0,n.createElement)(d.ToolbarButton,{icon:B.A,href:e,text:(0,k.__)("Dashboard","better-wp-security")}),(0,n.createElement)(Y,{area:"actions"})))}const W=(0,b.A)("nav",{target:"edhe72i2"})("display:flex;border-bottom:1px solid ",(({theme:e})=>e.colors.border.normal),";"),q=(0,b.A)(_.k2,{target:"edhe72i1"})("display:flex;text-decoration:none;align-items:center;&.active{box-shadow:inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),";}&:focus{color:",(({theme:e})=>e.colors.text.dark),";box-shadow:inset 0 0 0 2px ",(({theme:e})=>e.colors.border.info),",inset 0 -4px 0 0 ",(({theme:e})=>e.colors.border.info),"!important;border-radius:3px!important;}"),J=(0,b.A)(h.EY,{target:"edhe72i0"})({name:"1i2l0vb",styles:"padding:.75rem 1.25rem"}),K=(0,l.createContext)({size:h.$C.LARGE});function Q({className:e,size:t=h.$C.LARGE,children:a}){const r=(0,l.useMemo)((()=>({size:t})),[t]);return(0,n.createElement)(W,{className:e},(0,n.createElement)(K.Provider,{value:r},a))}function Z({title:e,...t}){const{size:a}=(0,l.useContext)(K);return(0,n.createElement)(q,t,(0,n.createElement)(J,{size:a,weight:h.uL.HEAVY,text:e,align:"center"}))}const X=(0,b.A)($.Ot,{shouldForwardProp:e=>"isSmall"!==e,target:"ec6rts80"})("height:",(({isSmall:e})=>e?"56px":"120px"),";width:",(({isSmall:e})=>e?"56px":"120px"),";");function ee({icon:e,isSmall:t=!1}){return(0,m.useMediaQuery)("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)")?e:(0,n.createElement)(X,{isSmall:t})}var te=a(31987),ae=a(46627);const ne=(0,b.A)($.zr,{target:"es1l7u91"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;"),re=(0,b.A)($.Gi,{target:"es1l7u90"})("height:",(({size:e})=>e),"px;width:auto;max-width:100%;");function oe({size:e=25,className:t}){const{installType:a}=(0,te.useSelect)((e=>({installType:e(ae.coreStore).getInstallType()})),[]);return"free"===a?(0,n.createElement)(ne,{size:e,className:t}):(0,n.createElement)(re,{size:e,className:t})}var le=a(98616),se=a.n(le),ie=a(76154),ce=a.n(ie),de=a(1417),me=a(89959);const ue=(0,b.A)("div",{target:"e1pwp6dm1"})({name:"aj6rbz",styles:"display:flex;gap:0.5rem"}),pe=(0,b.A)(h.$n,{target:"e1pwp6dm0"})({name:"1o3nkn",styles:"margin-left:auto"}),he=se()((()=>[{value:"24-hours",label:(0,k.__)("24 Hours","better-wp-security")},{value:"week",label:(0,k.__)("7 Days","better-wp-security")},{value:"30-days",label:(0,k.__)("30 Days","better-wp-security")},{value:"custom",label:(0,k.__)("Custom","better-wp-security")}]));function ge({value:e,onChange:t}){const[a,r]=(0,l.useState)(!1),[s,i]=(0,l.useState)(void 0),[c,m]=(0,l.useState)(void 0);let[u,p]=(0,l.useState)(void 0);const g=e,f=function(e){if(!e)return"No dates chosen";const t=new window.Date;let a,n;switch(e){case"24-hours":return(0,k.__)("24 Hours","better-wp-security");case"30-days":a=(0,me.dateI18n)("M j",t.setDate(t.getDate()-30)),n=(0,me.dateI18n)("M j, Y");break;case"week":a=(0,me.dateI18n)("M j",t.setDate(t.getDate()-7)),n=(0,me.dateI18n)("M j, Y");break;default:a=(0,me.dateI18n)("M j",e.start),n=(0,me.dateI18n)("M j, Y",e.end)}return(0,k.sprintf)((0,k.__)("%1$s - %2$s","better-wp-security"),a,n)}(g);return u=u||((0,o.isString)(g)?g:"custom"),(0,n.createElement)("div",null,(0,n.createElement)(h.$n,{onClick:()=>r(!a),title:f,"aria-expanded":a,"aria-label":(0,k.sprintf)((0,k.__)("%s (click to edit)","better-wp-security"),f),variant:"tertiary",text:f,icon:de.A,iconPosition:"right"}),a&&(0,n.createElement)(d.Modal,{title:(0,k.__)("Change Date Period","better-wp-security"),onRequestClose:()=>r(!1)},(0,n.createElement)(d.SelectControl,{options:he(),value:u,onChange:e=>p(e)}),(0,n.createElement)(ue,null,"custom"===u&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)(d.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,n.createElement)(h.$n,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,k.sprintf)((0,k.__)("From: %s (click to edit","better-wp-security"),(0,me.dateI18n)("M j",s)),text:(0,k.sprintf)((0,k.__)("From %s","better-wp-security"),(0,me.dateI18n)("M j",s))}),renderContent:()=>(0,n.createElement)(d.DatePicker,{currentDate:s,onChange:i,isInvalidDate:e=>{if((0,me.isInTheFuture)(e))return!0;const t=new window.Date;return t.setDate(t.getDate()-60),e<t}})}),(0,n.createElement)(d.Dropdown,{renderToggle:({isOpen:e,onToggle:t})=>(0,n.createElement)(h.$n,{variant:"secondary",onClick:t,"aria-expanded":e,"aria-label":(0,k.sprintf)((0,k.__)("To: %s (click to edit","better-wp-security"),(0,me.dateI18n)("M j",c)),text:(0,k.sprintf)((0,k.__)("To: %s (click to edit","better-wp-security"),(0,me.dateI18n)("M j",c))}),renderContent:()=>(0,n.createElement)(d.DatePicker,{currentDate:c,onChange:m,isInvalidDate:e=>!!(0,me.isInTheFuture)(e)||(0,me.getDate)(s)>e})})),(0,n.createElement)(pe,{variant:"primary",onClick:e=>{let a;if(e.preventDefault(),"custom"===u){const e=ce()(s).set({hour:0,minute:0,second:0}),t=ce()(c).set({hour:23,minute:59,second:59});a={start:(0,me.format)("Y-m-d\\TH:i:s",e),end:(0,me.format)("Y-m-d\\TH:i:s",t)}}else a=u;t(a),r(!1)},text:(0,k.__)("Apply","better-wp-security")}))))}const fe=(0,b.A)(d.Icon,{target:"ebvjfo71"})({name:"1svyz14",styles:"background-color:#438C56;border-radius:2rem"}),be=(0,b.A)(d.Icon,{target:"ebvjfo70"})({name:"x749hy",styles:"background-color:#E6505466;border-radius:2rem;height:0.813rem!important;width:0.813rem!important;padding:2px"});var Ee=a(28351),ve=a(14707),ye=a(4818);function xe(){const{versionActive:e,versionSettings:t,installType:a}=(0,te.useSelect)((e=>({versionActive:e(ae.modulesStore).isActive("version-management"),versionSettings:e(ae.modulesStore).getSettings("version-management"),installType:e(ae.coreStore).getInstallType()})),[]),r=e&&t.update_if_vulnerable,o="free"===a,l=r?(0,k.__)("Real-Time Updates Active","better-wp-security"):(0,k.__)("Real-Time Updates Inactive","better-wp-security"),s=o?(0,k.__)("Upgrade","better-wp-security"):(0,k.__)("Enable “Auto Update If Fixes Vulnerability” in Version Management","better-wp-security"),i=r?(0,n.createElement)(fe,{icon:Ee.A}):(0,n.createElement)(be,{icon:ve.A,style:{fill:"#8A2424"}});return(0,n.createElement)(h.Ex,{text:l,icon:i,iconColor:"#FFFFFF",tooltip:s})}function _e(){const{hasPatchstack:e,installType:t}=(0,te.useSelect)((e=>({hasPatchstack:e(ae.coreStore).hasPatchstack(),installType:e(ae.coreStore).getInstallType()})),[]),a="free"===t,r=e?(0,k.__)("Virtual Patching Active","better-wp-security"):(0,k.__)("Virtual Patching Inactive","better-wp-security"),o=a?(0,k.__)("Upgrade","better-wp-security"):null,l=e?ye.A:(0,n.createElement)(be,{icon:ve.A,style:{fill:"#8A2424"}});return(0,n.createElement)(h.Ex,{text:r,icon:l,iconColor:"#6817C5",tooltip:o})}a(55933);var Ie=a(16957);const Ae=(0,l.createContext)({preloaded:{}});function Ne({preload:e,children:t}){const[a,r]=(0,l.useState)({preloaded:{}}),o=(0,l.useCallback)(((e,t)=>{r((a=>({...a,preloaded:{...a.preloaded,[e]:t}})))}),[r]);return(0,l.useEffect)((()=>{for(const t of e)a.preloaded.hasOwnProperty(t)||(o(t,void 0),fetch(ke(t)).then((e=>e.arrayBuffer())).then((e=>o(t,e))).catch((e=>{console.error(`[Solid Security] Could not load rive graphic '${t}': ${e}`),o(t,null)})))}),[e,a.preloaded,o]),(0,n.createElement)(Ae.Provider,{value:a},t)}function Ce(e,t,a){const{preloaded:n}=(0,l.useContext)(Ae);return n[e]?t.buffer=n[e]:t.src=ke(e),(0,Ie.useRive)(t,a)}function ke(e){return`${itsecWebpackPublicPath}../core/img/rive/${e}.riv`}}}]);