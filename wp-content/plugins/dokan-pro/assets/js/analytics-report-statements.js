"use strict";(globalThis.webpackChunkdokan_pro=globalThis.webpackChunkdokan_pro||[]).push([[8815],{3734:(e,a,t)=>{t.r(a),t.d(a,{default:()=>v});var s=t(3832),d=t(7723),r=t(6427),n=t(6087),o=t(3973),l=t(1641),i=t(1455),c=t.n(i),m=t(790);const g=()=>(0,m.jsxs)("div",{className:"w-full space-y-6 animate-pulse pr-4 pb-4",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center",children:[(0,m.jsxs)("div",{className:"flex gap-4",children:[(0,m.jsx)("div",{className:"h-10 w-40 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-10 w-40 bg-gray-200 rounded"})]}),(0,m.jsx)("div",{className:"h-10 w-32 bg-gray-200 rounded"})]}),(0,m.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,m.jsxs)("div",{className:"p-4 bg-white rounded shadow border space-y-2",children:[(0,m.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-8 w-32 bg-gray-200 rounded"})]}),(0,m.jsxs)("div",{className:"p-4 bg-white rounded shadow border space-y-2",children:[(0,m.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-8 w-32 bg-gray-200 rounded"})]}),(0,m.jsxs)("div",{className:"p-4 bg-white rounded shadow border space-y-2",children:[(0,m.jsx)("div",{className:"h-6 w-24 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-8 w-32 bg-gray-200 rounded"})]})]})]}),h=()=>(0,m.jsxs)("div",{className:"w-full space-y-6 animate-pulse pr-4 pb-4",children:[(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,m.jsxs)("div",{className:"grid grid-cols-7 gap-4 p-4 bg-gray-50",children:[(0,m.jsx)("div",{className:"h-4 w-28 bg-gray-200 rounded"})," ",(0,m.jsx)("div",{className:"h-4 w-28 bg-gray-200 rounded"})," ",(0,m.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded"})," ",(0,m.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded"})," ",(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded"})," ",(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded"})," ",(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded"})," "]}),[1,2,3,4,5,6,7,8].map((e=>(0,m.jsxs)("div",{className:"grid grid-cols-7 gap-4 p-4 border-t border-gray-200",children:[(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-4 w-12 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-4 w-16 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-4 w-20 bg-gray-200 rounded"})]},e)))]}),(0,m.jsxs)("div",{className:"flex justify-between items-center p-4",children:[(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsx)("div",{className:"h-8 w-24 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-8 w-24 bg-gray-200 rounded"})]}),(0,m.jsxs)("div",{className:"flex gap-2",children:[(0,m.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded"}),(0,m.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded"})]})]})]});var b=t(4408),u=t(7832),x=t(8486),p=t(8846),_=t(2619);const y=e=>{var a;const t=(0,n.useRef)(null);(0,x.Wr)(t,(()=>e.setShow(!e.show)));const s=(0,_.applyFilters)("dokan_analytics_report_statement_date_range_picker_props",{...e});return(0,m.jsxs)(b.AM,{className:"relative",children:[(0,m.jsx)(b.ut,{onClick:()=>s.setShow(!s.show),className:"shadow-none w-full focus:outline-none p-0",children:null!==(a=e.children)&&void 0!==a?a:""}),(0,m.jsx)(u.e,{show:s.show,enter:"transition duration-200 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-150 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,m.jsx)(b.QT,{anchor:"bottom",className:"absolute flex rounded shadow-xl border",children:(0,m.jsx)("div",{className:"w-auto flex-auto overflow-hidden bg-white z-40",ref:t,children:(0,m.jsx)(p.DateRange,{...s})})})})]})};var j=t(8443);const v=()=>{const e=(0,l.dj)(),[a,t]=(0,n.useState)(!0),[i,b]=(0,n.useState)(!0),[u,x]=(0,n.useState)([{end_date:"",start_date:"",formatted_entries:[],summary:{total_debit:0,total_credit:0,balance:0}}]),[p,_]=(0,n.useState)([]),[v,w]=(0,n.useState)({start_date:u.start_date,end_date:u.end_date}),[f,N]=(0,n.useState)({page:1,perPage:10,type:"table",titleField:"balance_date",fields:["trn_date","trn_id","trn_type","debit","credit","balance"]}),[k,S]=(0,n.useState)({total_debit:0,total_credit:0,balance:0}),[T,D]=(0,n.useState)(u.start_date),[I,C]=(0,n.useState)(""),[F,M]=(0,n.useState)(u.end_date),[P,E]=(0,n.useState)(""),[B,H]=(0,n.useState)("startDate"),[O,R]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async a=>{b(!0);try{const e=await c()({path:(0,s.addQueryArgs)("/dokan/v1/vendor/reports/statement/summary",a),method:"GET"});S(e)}catch(a){e({type:"error",title:a.message||(0,d.__)("Failed to fetch summary data","dokan")}),u.summary&&S(u.summary)}finally{b(!1)}})({end_date:v.end_date,start_date:v.start_date})}),[v]),(0,n.useEffect)((()=>{(async a=>{t(!0);try{const e=await c()({path:(0,s.addQueryArgs)("/dokan/v1/vendor/reports/statement",a),method:"GET"});x(e)}catch(a){e({type:"error",title:a.message||(0,d.__)("Failed to fetch statement data","dokan")})}finally{t(!1)}})({per_page:-1,page:f.page,end_date:v.end_date,start_date:v.start_date})}),[v]);const Y=[{id:"balance_date",label:(0,d.__)("Balance Date","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):(0,j.dateI18n)((0,j.getSettings)().formats.date,e.balance_date),enableSorting:!1},{id:"trn_date",label:(0,d.__)("Transaction Date","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):e.trn_date?(0,j.dateI18n)((0,j.getSettings)().formats.date,e.trn_date):(0,d.__)("--","dokan"),enableSorting:!1},{id:"trn_id",label:(0,d.__)("ID","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):e.trn_id?(0,m.jsx)("a",{href:e.url,className:"statement-order-id",children:(0,d.sprintf)((0,d.__)("#%s","dokan"),e.trn_id)}):(0,d.__)("--","dokan"),enableSorting:!1},{id:"trn_type",label:(0,d.__)("Type","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):e.trn_title,enableSorting:!1},{id:"debit",label:(0,d.__)("Debit","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):"opening_balance"!==e?.trn_type?(0,m.jsx)(o.PriceHtml,{price:e?.debit}):(0,d.__)("--","dokan"),enableSorting:!1},{id:"credit",label:(0,d.__)("Credit","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):"opening_balance"!==e?.trn_type?(0,m.jsx)(o.PriceHtml,{price:e?.credit}):(0,d.__)("--","dokan"),enableSorting:!1},{id:"balance",label:(0,d.__)("Balance","dokan"),render:({item:e})=>a?(0,m.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse"}):(0,m.jsx)(o.PriceHtml,{price:e?.balance}),enableSorting:!1}],[L,U]=(0,n.useState)(!1),{data:A,paginationInfo:G}=(0,n.useMemo)((()=>(0,o.filterSortAndPaginate)(u,f,Y)),[f]);return(0,m.jsxs)(n.Suspense,{fallback:(0,m.jsx)(r.Spinner,{}),children:[(0,m.jsx)(r.Fill,{name:"woocommerce_header_item",children:(0,m.jsx)("h3",{className:"dokan-analytics-vendor-earning-section dokan-layout",children:(0,m.jsx)(o.DokanButton,{variant:"primary",onClick:async()=>{R(!0);const a=(0,j.dateI18n)("Y-m-d",v.start_date||vendorSharedSettings?.firstDayOfTheMonth),t=(0,j.dateI18n)("Y-m-d",v.end_date||vendorSharedSettings?.endDayOfTheMonth);try{const s=await c()({path:`/dokan/v1/vendor/reports/statement/export?start_date=${a}&end_date=${t}`,method:"GET"}),r=new Blob([s.content],{type:"text/csv"}),n=window.URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=`${s.file_name}.csv`,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(n),document.body.removeChild(o),e({type:"success",title:(0,d.__)("Statement exported successfully","dokan")})}catch(a){e({type:"error",title:a.message||(0,d.__)("Failed to export statement","dokan")})}finally{R(!1)}},disabled:i||O,children:(0,d.__)("Export Statement","dokan")})})}),(0,m.jsxs)("div",{className:"dokan-report-statement-wrapper pr-4 pb-4",children:[(0,m.jsx)("span",{className:"woocommerce-filters-label",children:(0,d.__)("Statement range:","dokan")}),i?(0,m.jsx)(g,{}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,m.jsx)("div",{className:"flex gap-4",children:(0,m.jsx)(y,{show:L,after:T,setShow:U,afterText:I,before:F,beforeText:P,onUpdate:e=>{e.after&&D(e.after),e.afterText&&C(e.afterText),e.before&&(M(e.before),w({start_date:e.after,end_date:e.before})),e.beforeText&&E(e.beforeText),e.focusedInput&&(H(e.focusedInput),"endDate"!==e.focusedInput&&U(!1),"endDate"===e.focusedInput&&T&&(M(""),E(""),U(!0)))},shortDateFormat:"MM/DD/YYYY",focusedInput:B,isInvalidDate:e=>moment().isBefore(moment(e),"date"),children:(0,m.jsx)("div",{className:"dokan-layout w-96",children:(0,m.jsx)("span",{className:"components-button woocommerce-dropdown-button is-multi-line p-2.5 h-full justify-start",children:(0,m.jsx)("span",{className:"woocommerce-dropdown-button__label font-semibold",children:(0,d.sprintf)((0,d.__)("%s - %s","dokan"),(0,j.dateI18n)((0,j.getSettings)().formats.date,v.start_date||u.start_date||vendorSharedSettings?.firstDayOfTheMonth),(0,j.dateI18n)((0,j.getSettings)().formats.date,v.end_date||u.end_date||vendorSharedSettings?.lastDayOfTheMonth))})})})})})}),(0,m.jsxs)("div",{className:"mb-6 grid grid-cols-3 gap-4",children:[(0,m.jsxs)("div",{className:"p-4 bg-white rounded shadow border border-solid border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-bold mb-2",children:(0,d.__)("Total Debit","dokan")}),i?(0,m.jsx)("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"}):(0,m.jsx)("p",{className:"text-2xl font-semibold text-dokan-primary active-title m-0",children:(0,m.jsx)(o.PriceHtml,{price:k?.total_debit})})]}),(0,m.jsxs)("div",{className:"p-4 bg-white rounded shadow border border-solid border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-bold mb-2",children:(0,d.__)("Total Credit","dokan")}),i?(0,m.jsx)("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"}):(0,m.jsx)("p",{className:"text-2xl font-semibold text-dokan-primary active-title m-0",children:(0,m.jsx)(o.PriceHtml,{price:k?.total_credit})})]}),(0,m.jsxs)("div",{className:"p-4 bg-white rounded shadow border border-solid border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-bold mb-2",children:(0,d.__)("Balance","dokan")}),i?(0,m.jsx)("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"}):(0,m.jsx)("p",{className:"text-2xl font-semibold text-dokan-primary active-title m-0",children:(0,m.jsx)(o.PriceHtml,{price:k?.balance})})]})]})]}),i||a?(0,m.jsx)(h,{}):(0,m.jsx)("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:(0,m.jsx)(o.DataViews,{view:f,fields:Y,data:A,selection:p,onChangeView:N,onChangeSelection:_,getItemId:e=>e.trn_id||e.balance_date,namespace:"report-statement",defaultLayouts:{density:"comfortable"},paginationInfo:G})})]})]})}}}]);