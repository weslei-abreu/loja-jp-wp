(globalThis.webpackChunkdokan_pro=globalThis.webpackChunkdokan_pro||[]).push([[5113],{1959:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var a=r(6087),o=r(5556),s=r.n(o),n=r(7723),i=r(2619);const l=(0,i.applyFilters)("dokan_analytics_stock_report_advanced_filters",{filters:{},title:(0,n._x)("Products Match <select/> Filters","A sentence describing filters for Products. See screen shot for context: https://cloudup.com/cSsUY9VeCVJ","dokan")}),c=(0,i.applyFilters)("dokan_analytics_stock_report_filters",[{label:(0,n.__)("Show","dokan"),staticParams:["paged","per_page"],param:"type",showFilters:()=>!0,filters:[{label:(0,n.__)("All products","dokan"),value:"all"},{label:(0,n.__)("Out of stock","dokan"),value:"outofstock"},{label:(0,n.__)("Low stock","dokan"),value:"lowstock"},{label:(0,n.__)("In stock","dokan"),value:"instock"},{label:(0,n.__)("On backorder","dokan"),value:"onbackorder"}]},{label:(0,n.__)("Filter by","dokan"),staticParams:["paged","per_page"],param:"filter",showFilters:()=>Object.keys(l.filters).length,filters:[{label:(0,n.__)("All Products","dokan"),value:"all"},{label:(0,n.__)("Advanced Filters","dokan"),value:"advanced"}]}]);var d=r(8537),u=r(8846),p=r(6476),m=r(3577),y=r(5703),_=r(4111),h=r(8660),g=r(274),b=r(7345),k=r(790);const f=(0,g.Qk)("stockStatuses",{instock:(0,n.__)("In stock","dokan"),outofstock:(0,n.__)("Out of stock","dokan"),onbackorder:(0,n.__)("On backorder","dokan")});class v extends a.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:(0,n.__)("Product / Variation","dokan"),key:"title",required:!0,isLeftAligned:!0,isSortable:!0},{label:(0,n.__)("SKU","dokan"),key:"sku",isSortable:!0},{label:(0,n.__)("Status","dokan"),key:"stock_status",isSortable:!0,defaultSort:!0},{label:(0,n.__)("Stock","dokan"),key:"stock_quantity",isSortable:!0}]}getRowsContent(e=[]){const{query:t}=this.props,r=(0,p.getPersistedQuery)(t);return e.map((e=>{const{id:t,manage_stock:a,parent_id:o,sku:s,stock_quantity:i,stock_status:l,low_stock_amount:c}=e,_=(0,d.decodeEntities)(e.name),h=(0,b.T)((0,p.getNewPath)(r,"/analytics/products",{filter:"single_product",products:o||t})),g=(0,k.jsx)(u.Link,{href:h,type:"wc-admin",children:_}),v=(0,y.getAdminLink)("post.php?action=edit&post="+(o||t));var S,C,w;return[{display:g,value:_},{display:s,value:s},{display:(S=l,w=c,(C=i)&&S&&C<=w==="instock"?(0,k.jsx)(u.Link,{href:v,type:"wp-admin",children:(0,n._x)("Low","Indication of a low quantity","dokan")}):(0,k.jsx)(u.Link,{href:v,type:"wp-admin",children:f[l]})),value:f[l]},{display:a?(0,m.formatValue)(this.context.getCurrencyConfig(),"number",i):(0,n.__)("N/A","dokan"),value:i}]}))}getSummary(e){const{products:t=0,outofstock:r=0,lowstock:a=0,instock:o=0,onbackorder:s=0}=e,i=this.context.getCurrencyConfig();return[{label:(0,n._n)("Product","Products",t,"dokan"),value:(0,m.formatValue)(i,"number",t)},{label:(0,n.__)("Out of stock","dokan"),value:(0,m.formatValue)(i,"number",r)},{label:(0,n.__)("Low stock","dokan"),value:(0,m.formatValue)(i,"number",a)},{label:(0,n.__)("On backorder","dokan"),value:(0,m.formatValue)(i,"number",s)},{label:(0,n.__)("In stock","dokan"),value:(0,m.formatValue)(i,"number",o)}]}render(){const{advancedFilters:e,filters:t,query:r}=this.props;return(0,k.jsx)(h.A,{endpoint:"stock",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,getSummary:this.getSummary,summaryFields:["products","outofstock","lowstock","instock","onbackorder"],query:r,tableQuery:{orderby:r.orderby||"stock_status",order:r.order||"asc",type:r.type||"all"},title:(0,n.__)("Stock","dokan"),filters:t,advancedFilters:e})}}v.contextType=_.CurrencyContext;const S=v;var C=r(8222);class w extends a.Component{render(){const{query:e,path:t}=this.props;return(0,k.jsxs)(a.Fragment,{children:[(0,k.jsx)(C.A,{query:e,path:t,showDatePicker:!1,filters:c,advancedFilters:l,report:"stock"}),(0,k.jsx)(S,{query:e,filters:c,advancedFilters:l})]})}}w.propTypes={query:s().object.isRequired}},2694:(e,t,r)=>{"use strict";var a=r(6925);function o(){}function s(){}s.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,s,n){if(n!==a){var i=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw i.name="Invariant Violation",i}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:o};return r.PropTypes=r,r}},4351:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(7723),o=r(5556),s=r.n(o),n=r(8846),i=r(790);function l({className:e}){const t=(0,a.__)("There was an error getting your stats. Please try again.","dokan"),r=(0,a.__)("Reload","dokan");return(0,i.jsx)(n.EmptyContent,{className:e,title:t,actionLabel:r,actionCallback:()=>{window.location.reload()}})}l.propTypes={className:s().string};const c=l},5556:(e,t,r)=>{e.exports=r(2694)()},6925:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8222:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var a=r(6087),o=r(9491),s=r(5556),n=r.n(s),i=r(8468),l=r(7143),c=r(7752),d=r(8846),u=r(314),p=r(7374),m=r(3306),y=r(4111),_=r(274),h=r(790);class g extends a.Component{constructor(){super(),this.onDateSelect=this.onDateSelect.bind(this),this.onFilterSelect=this.onFilterSelect.bind(this),this.onAdvancedFilterAction=this.onAdvancedFilterAction.bind(this)}onDateSelect(e){const{report:t,addCesSurveyForAnalytics:r}=this.props;r(),(0,m.recordEvent)("datepicker_update",{report:t,...(0,i.omitBy)(e,i.isUndefined)})}onFilterSelect(e){const{report:t,addCesSurveyForAnalytics:r}=this.props,a=e.filter||e["filter-variations"];["single_product","single_category","single_coupon","single_variation"].includes(a)&&r();const o={report:t,filter:e.filter||"all"};"single_product"===e.filter&&(o.filter_variation=e["filter-variations"]||"all"),(0,m.recordEvent)("analytics_filter",o)}onAdvancedFilterAction(e,t){const{report:r,addCesSurveyForAnalytics:a}=this.props;switch(e){case"add":(0,m.recordEvent)("analytics_filters_add",{report:r,filter:t.key});break;case"remove":(0,m.recordEvent)("analytics_filters_remove",{report:r,filter:t.key});break;case"filter":const e=Object.keys(t).reduce(((e,r)=>(e[(0,i.snakeCase)(r)]=t[r],e)),{});a(),(0,m.recordEvent)("analytics_filters_filter",{report:r,...e});break;case"clear_all":(0,m.recordEvent)("analytics_filters_clear_all",{report:r});break;case"match":(0,m.recordEvent)("analytics_filters_all_any",{report:r,value:t.match})}}render(){const{advancedFilters:e,filters:t,path:r,query:a,showDatePicker:o,defaultDateRange:s}=this.props,{period:n,compare:i,before:l,after:c}=(0,p.getDateParamsFromQuery)(a,s),{primary:u,secondary:m}=(0,p.getCurrentDates)(a,s),y={period:n,compare:i,before:l,after:c,primaryDate:u,secondaryDate:m},g=this.context;return(0,h.jsx)(d.ReportFilters,{query:a,siteLocale:_.ne.siteLocale,currency:g.getCurrencyConfig(),path:r,filters:t,advancedFilters:e,showDatePicker:o,onDateSelect:this.onDateSelect,onFilterSelect:this.onFilterSelect,onAdvancedFilterAction:this.onAdvancedFilterAction,dateQuery:y,isoDateFormat:p.isoDateFormat})}}g.contextType=y.CurrencyContext;const b=(0,o.compose)((0,l.withSelect)((e=>{const{woocommerce_default_date_range:t}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{defaultDateRange:t}})),(0,l.withDispatch)((e=>{const{addCesSurveyForAnalytics:t}=e(c.STORE_KEY);return{addCesSurveyForAnalytics:t}})))(g);g.propTypes={advancedFilters:n().object,filters:n().array,path:n().string.isRequired,query:n().object,showDatePicker:n().bool,report:n().string.isRequired}},8660:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var a=r(6427),o=r(2619),s=r(6087),n=r(9491),i=r(8107),l=r(7143),c=r(8468),d=r(7723),u=r(5556),p=r.n(u),m=r(7752),y=r(8846),_=r(6476),h=r(1554),g=r(314),b=r(3306),k=r(790);const f=()=>(0,k.jsx)("svg",{role:"img","aria-hidden":"true",focusable:"false",version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{d:"M18,9c-0.009,0-0.017,0.002-0.025,0.003C17.72,5.646,14.922,3,11.5,3C7.91,3,5,5.91,5,9.5c0,0.524,0.069,1.031,0.186,1.519 C5.123,11.016,5.064,11,5,11c-2.209,0-4,1.791-4,4c0,1.202,0.541,2.267,1.38,3h18.593C22.196,17.089,23,15.643,23,14 C23,11.239,20.761,9,18,9z M12,16l-4-5h3V8h2v3h3L12,16z"})});var v=r(4351);const S=e=>{const{getHeadersContent:t,getRowsContent:r,getSummary:n,isRequesting:l,primaryData:u,tableData:p,endpoint:m,itemIdField:S,tableQuery:C,compareBy:w,compareParam:x,searchBy:F,labels:R={},...E}=e,{query:q,columnPrefsKey:T}=e,{items:A,query:D}=p,j=q[x]?(0,_.getIdsFromQuery)(q[w]):[],[P,O]=(0,s.useState)(j),N=(0,s.useRef)(null),{updateUserPreferences:I,...Q}=(0,g.useUserPreferences)();if(p.isError||u.isError)return(0,k.jsx)(v.A,{});let L=[];T&&(L=Q&&Q[T]?Q[T]:L);const B=(e,a,s)=>{const i=n?n(a,s):null;return(0,o.applyFilters)("dokan_analytics_report_table",{endpoint:m,headers:t(),rows:r(e),totals:a,summary:i,items:A})},V=t=>{const{ids:r}=e;O(t?r:[])},M=(t,r)=>{const{ids:a}=e;if(r)O((0,c.uniq)([a[t],...P]));else{const e=P.indexOf(a[t]);O([...P.slice(0,e),...P.slice(e+1)])}},U=t=>{const{ids:r=[]}=e,o=-1!==P.indexOf(r[t]);return{display:(0,k.jsx)(a.CheckboxControl,{onChange:(0,c.partial)(M,t),checked:o}),value:!1}},H=l||p.isRequesting||u.isRequesting,Y=(0,c.get)(u,["data","totals"],{}),K=A.totalResults||0,W=K>0,z=(0,_.getSearchWords)(q).map((e=>({key:e,label:e}))),{data:G}=A,J=B(G,Y,K);let{headers:X,rows:Z}=J;const{summary:$}=J;w&&(Z=Z.map(((e,t)=>[U(t),...e])),X=[(()=>{const{ids:t=[]}=e,r=t.length>0,o=r&&t.length===P.length;return{cellClassName:"is-checkbox-column",key:"compare",label:(0,k.jsx)(a.CheckboxControl,{onChange:V,"aria-label":(0,d.__)("Select All","dokan"),checked:o,disabled:!r}),required:!0}})(),...X]);const ee=((e,t)=>t?e.map((e=>({...e,visible:e.required||!t.includes(e.key)}))):e.map((e=>({...e,visible:e.required||!e.hiddenByDefault}))))(X,L);return(0,k.jsxs)(s.Fragment,{children:[(0,k.jsx)("div",{className:"woocommerce-report-table__scroll-point",ref:N,"aria-hidden":!0}),(0,k.jsx)(y.TableCard,{className:"woocommerce-report-table",hasSearch:!!F,actions:[w&&(0,k.jsx)(y.CompareButton,{className:"woocommerce-table__compare",count:P.length,helpText:R.helpText||(0,d.__)("Check at least two items below to compare","dokan"),onClick:()=>{w&&(0,_.onQueryChange)("compare")(w,x,P.join(","))},disabled:!W,children:R.compareButton||(0,d.__)("Compare","dokan")},"compare"),F&&(0,k.jsx)(y.Search,{allowFreeTextSearch:!0,inlineTags:!0,onChange:t=>{const{baseSearchQuery:r,addCesSurveyForCustomerSearch:a}=e,o=t.map((e=>e.label.replace(",","%2C")));o.length?((0,_.updateQueryString)({filter:void 0,[x]:void 0,[F]:void 0,...r,search:(0,c.uniq)(o).join(",")}),a()):(0,_.updateQueryString)({search:void 0}),(0,b.recordEvent)("analytics_table_filter",{report:m})},placeholder:R.placeholder||(0,d.__)("Search by item name","dokan"),selected:z,showClearButton:!0,type:F,disabled:!W},"search"),W&&(0,k.jsxs)(a.Button,{className:"woocommerce-table__download-button",disabled:H,onClick:()=>{const{createNotice:t,startExport:r,title:a}=e,o=Object.assign({},q),{data:s,totalResults:n}=A;let i="browser";if(delete o.extended_info,o.search&&delete o[F],s&&s.length===n){const{headers:e,rows:t}=B(s,n);(0,h.downloadCSVFile)((0,h.generateCSVFileName)(a,o),(0,h.generateCSVDataFromTable)(e,t))}else i="email",r(m,D).then((()=>t("success",(0,d.sprintf)(/* translators: %s = type of report */ /* translators: %s = type of report */
(0,d.__)("Your %s Report will be emailed to you.","dokan"),a)))).catch((e=>t("error",e.message||(0,d.sprintf)(/* translators: %s = type of report */ /* translators: %s = type of report */
(0,d.__)("There was a problem exporting your %s Report. Please try again.","dokan"),a))));(0,b.recordEvent)("analytics_table_download",{report:m,rows:n,download_type:i})},children:[(0,k.jsx)(f,{}),(0,k.jsx)("span",{className:"woocommerce-table__download-button__label",children:R.downloadButton||(0,d.__)("Download","dokan")})]},"download")],headers:ee,isLoading:H,onQueryChange:_.onQueryChange,onColumnsChange:(e,t)=>{const r=X.map((e=>e.key)).filter((t=>!e.includes(t)));if(T&&I({[T]:r}),t){const r={report:m,column:t,status:e.includes(t)?"on":"off"};(0,b.recordEvent)("analytics_table_header_toggle",r)}},onSort:(e,t)=>{(0,_.onQueryChange)("sort")(e,t);const r={report:m,column:e,direction:t};(0,b.recordEvent)("analytics_table_sort",r)},onPageChange:(e,t)=>{N.current.scrollIntoView();const r=N.current.nextSibling.querySelector(".woocommerce-table__table"),a=i.focus.focusable.find(r);a.length&&a[0].focus(),t&&("goto"===t?(0,b.recordEvent)("analytics_table_go_to_page",{report:m,page:e}):(0,b.recordEvent)("analytics_table_page_click",{report:m,direction:t}))},rows:Z,rowsPerPage:parseInt(D.per_page,10)||g.QUERY_DEFAULTS.pageSize,summary:$,totalRows:K,...E})]})};S.propTypes={baseSearchQuery:p().object,compareBy:p().string,compareParam:p().string,columnPrefsKey:p().string,endpoint:p().string,extendItemsMethodNames:p().shape({getError:p().string,isRequesting:p().string,load:p().string}),extendedItemsStoreName:p().string,getHeadersContent:p().func.isRequired,getRowsContent:p().func.isRequired,getSummary:p().func,itemIdField:p().string,labels:p().shape({compareButton:p().string,downloadButton:p().string,helpText:p().string,placeholder:p().string}),primaryData:p().object,searchBy:p().string,summaryFields:p().arrayOf(p().string),tableData:p().object.isRequired,tableQuery:p().object,title:p().string.isRequired},S.defaultProps={primaryData:{},tableData:{items:{data:[],totalResults:0},query:{}},tableQuery:{},compareParam:"filter",downloadable:!1,onSearch:c.noop,baseSearchQuery:{}};const C=[],w={},x=(0,n.compose)((0,l.withSelect)(((e,t)=>{const{endpoint:r,getSummary:a,isRequesting:o,itemIdField:s,query:n,tableData:i,tableQuery:l,filters:d,advancedFilters:u,summaryFields:p,extendedItemsStoreName:m}=t,y=e(g.REPORTS_STORE_NAME),_=m?e(m):null,{woocommerce_default_date_range:h}=e(g.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),b=n.search&&!(n[r]&&n[r].length);if(o||b)return w;const k="categories"===r?"products":r,f=a?(0,g.getReportChartData)({endpoint:k,selector:y,dataType:"primary",query:n,filters:d,advancedFilters:u,defaultDateRange:h,fields:p}):w,v=i||(0,g.getReportTableData)({endpoint:r,query:n,selector:y,tableQuery:l,filters:d,advancedFilters:u,defaultDateRange:h}),S=_?function(e,t,r){const{extendItemsMethodNames:a,itemIdField:o}=t,s=r.items.data;if(!(Array.isArray(s)&&s.length&&a&&o))return r;const{[a.getError]:n,[a.isRequesting]:i,[a.load]:l}=e,d={include:s.map((e=>e[o])).join(","),per_page:s.length},u=l(d),p=!!i&&i(d),m=!!n&&n(d),y=s.map((e=>{const t=(0,c.first)(u.filter((t=>e.id===t.id)));return{...e,...t}})),_=r.isRequesting||p,h=r.isError||m;return{...r,isRequesting:_,isError:h,items:{...r.items,data:y}}}(_,t,v):v;return{primaryData:f,ids:s&&S.items.data?S.items.data.map((e=>e[s])):C,tableData:S,query:n}})),(0,l.withDispatch)((e=>{const{startExport:t}=e(g.EXPORT_STORE_NAME),{createNotice:r}=e("core/notices"),{addCesSurveyForCustomerSearch:a}=e(m.STORE_KEY);return{createNotice:r,startExport:t,addCesSurveyForCustomerSearch:a}})))(S)}}]);