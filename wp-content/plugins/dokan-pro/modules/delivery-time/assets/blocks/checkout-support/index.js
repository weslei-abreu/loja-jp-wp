(()=>{"use strict";var e,t={733:(e,t,o)=>{const i=window.wp.i18n,r=window.ReactJSXRuntime,s=({time:e=""})=>e?(0,r.jsxs)("div",{className:"header",children:[(0,r.jsx)("h3",{children:(0,i.__)("Delivery details","dokan")}),(0,r.jsxs)("div",{className:"delivery-timezone dokan-delivery-time-tooltip","data-tip":(0,i.__)("Date & time is based on current site time.","dokan"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",height:"18",viewBox:"0 0 24 24",stroke:"#333333",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.85",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:e})]})]}):"",l=({isLoading:e=!1})=>(0,r.jsx)("div",{id:"dokan-spinner-overlay",style:{display:e?"block":"none"},children:(0,r.jsx)("div",{className:"dokan-spinner-wrapper",children:(0,r.jsx)("span",{className:"dokan-loading-spinner"})})}),n=window.wp.element,a=({value:e="",onClick:t,isDeliveryEnabled:o=!1,isPickupEnabled:s=!1})=>(0,r.jsx)("div",{className:"dokan-store-location-selector",children:(0,r.jsxs)("div",{className:"selector-wrapper",children:[o&&(0,r.jsxs)("div",{onClick:()=>t("delivery"),"data-selector":"delivery",className:"selector mr-16 "+("delivery"===e?"active-selector":""),children:[(0,r.jsxs)("svg",{height:"18",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,r.jsx)("path",{d:"M386.689 304.403c-35.587 0-64.538 28.951-64.538 64.538s28.951 64.538 64.538 64.538c35.593 0 64.538-28.951 64.538-64.538s-28.951-64.538-64.538-64.538zm0 96.807c-17.796 0-32.269-14.473-32.269-32.269s14.473-32.269 32.269-32.269 32.269 14.473 32.269 32.269c0 17.797-14.473 32.269-32.269 32.269zM166.185 304.403c-35.587 0-64.538 28.951-64.538 64.538s28.951 64.538 64.538 64.538 64.538-28.951 64.538-64.538-28.951-64.538-64.538-64.538zm0 96.807c-17.796 0-32.269-14.473-32.269-32.269s14.473-32.269 32.269-32.269c17.791 0 32.269 14.473 32.269 32.269 0 17.797-14.473 32.269-32.269 32.269zM430.15 119.675a16.143 16.143 0 00-14.419-8.885h-84.975v32.269h75.025l43.934 87.384 28.838-14.5-48.403-96.268z"}),(0,r.jsx)("path",{d:"M216.202 353.345h122.084v32.269H216.202zM117.781 353.345H61.849c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h55.933c8.912 0 16.134-7.223 16.134-16.134 0-8.912-7.223-16.134-16.135-16.134zM508.612 254.709l-31.736-40.874a16.112 16.112 0 00-12.741-6.239H346.891V94.655c0-8.912-7.223-16.134-16.134-16.134H61.849c-8.912 0-16.134 7.223-16.134 16.134s7.223 16.134 16.134 16.134h252.773V223.73c0 8.912 7.223 16.134 16.134 16.134h125.478l23.497 30.268v83.211h-44.639c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h60.773c8.912 0 16.134-7.223 16.135-16.134V264.605c0-3.582-1.194-7.067-3.388-9.896zM116.706 271.597H42.487c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h74.218c8.912 0 16.134-7.223 16.134-16.134.001-8.911-7.222-16.134-16.133-16.134zM153.815 208.134H16.134C7.223 208.134 0 215.357 0 224.269s7.223 16.134 16.134 16.134h137.681c8.912 0 16.134-7.223 16.134-16.134s-7.222-16.135-16.134-16.135z"}),(0,r.jsx)("path",{d:"M180.168 144.672H42.487c-8.912 0-16.134 7.223-16.134 16.134 0 8.912 7.223 16.134 16.134 16.134h137.681c8.912 0 16.134-7.223 16.134-16.134.001-8.911-7.222-16.134-16.134-16.134z"})]}),(0,r.jsx)("span",{children:(0,i.__)("Delivery","dokan")}),(0,r.jsx)("div",{className:"dokan-delivery-time-tooltip info-icon","data-tip":(0,i.__)("Home delivery at your doorstep","dokan"),children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),s&&(0,r.jsxs)("div",{onClick:()=>t("pickup"),"data-selector":"store-pickup",className:"selector "+("pickup"===e?"active-selector":"pickup"),children:[(0,r.jsxs)("svg",{height:"18",viewBox:"0 0 512.456 512.456",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M446.125 305.557l-10.088-195.203h-64.368V35.309H259.952v75.046h-46.57V35.309H101.665v75.046H10.987L0 477.147h512.456v-171.59zm-38.578-165.203l8.539 165.203H309.907l-4.949-165.203h36.711v34.308h30v-34.308zm-65.878-75.045v45.046h-51.717V65.309zm-210.004 0h51.717v45.046h-51.717zM30.912 447.147l9.19-306.793h61.562v34.308h30v-34.308h51.717v34.308h30v-34.308h61.562l9.191 306.793zm283.237 0l-3.343-111.59h59.168v111.59zm168.307 0h-82.481v-111.59h82.481z"}),(0,r.jsx)("path",{d:"M106.68 280.182h101.688v30H106.68z"})]}),(0,r.jsx)("span",{children:(0,i.__)("Pickup","dokan")}),(0,r.jsx)("div",{className:"dokan-delivery-time-tooltip info-icon","data-tip":(0,i.__)("Pickup products from your preferred store location","dokan"),children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]})}),d=window.wp.apiFetch;var c=o.n(d);const{addQueryArgs:v}=wp.url,{SelectControl:_}=wp.components,p=({vendorId:e,info:t,onChange:o,values:s,setLoading:l})=>{var d,p,h,u,m,y,k,x,j,f,w,g;const b=(0,n.useRef)(null),[S,z]=(0,n.useState)({vendor_id:e,store_name:null!==(d=t?.store_name)&&void 0!==d?d:"",delivery_date:null!==(p=s?.delivery_date)&&void 0!==p?p:"",selected_delivery_type:null!==(h=s?.selected_delivery_type)&&void 0!==h?h:"delivery",delivery_time_slot:null!==(u=s?.delivery_time_slot)&&void 0!==u?u:"",store_pickup_location:null!==(m=s?.store_pickup_location)&&void 0!==m?m:"",timeSlots:null!==(y=s?.timeSlots)&&void 0!==y?y:[],locationSlots:null!==(k=s?.locationSlots)&&void 0!==k?k:[]});(0,n.useEffect)((()=>{(()=>{const e={disable:[],minDate:"today",altInput:!0,altFormat:window.dokan_helper.i18n_date_format.replace("jS","J"),dateFormat:"Y-m-d",locale:dokan_flatpickr_i18n,disableDays:[],onChange:D};let o=[];const i=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],r=t.vendor_delivery_options?.delivery_day,s=void 0!==r?Object.entries(r).map((e=>parseInt(e[1])||e[0]===e[1]?e[0]:"")).filter((e=>null!==e?e:"")):[];if(!s.length)return;o=s;const l=[];i.forEach((e=>{o.includes(e)||l.push(i.indexOf(e))})),e.disableDays=[function(e){return l.includes(e.getDay())}],e.disable=[...e.disableDays];const n=t.vendor_vacation_days,a=t.vendor_preorder_blocked_dates;e.disable=[...e.disableDays,...n,...a],delete e.disableDays,window.flatpickr(b.current,e)})()}),[]);const N=e=>{z(e),o(e)},M=e=>(l(!0),c()({path:v("/dokan/v1/delivery-time/time-slot",{vendorId:e.vendor_id,date:e.delivery_date})}).then((t=>{if("object"==typeof t){const i={...e};return i.delivery_time_slot="",i.timeSlots=Object.keys(t),z(i),o(i),i}throw new Error("Invalid response format")})).finally((()=>{l(!1)}))),O=e=>(l(!0),c()({path:v("/dokan/v1/delivery-time/location-slot",{vendorId:e.vendor_id})}).then((t=>{if("object"==typeof t){const i={...e};return i.locationSlots=Object.values(t),z(i),o(i),i}throw new Error("Invalid response format")})).finally((()=>(l(!1),!0))));function D(e,t,o){const i={...S,delivery_date:t};O(i).then((e=>{M(e)}))}const C=e=>e?{name:e.split("(")[0],address:e.match(/\((.*?)\)/)[1]}:{name:"",address:""};return(0,r.jsxs)("div",{className:"delivery-group",children:[(0,r.jsxs)("div",{className:"title",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",height:"22",viewBox:"0 0 24 24",stroke:"#333333",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,r.jsx)("span",{children:null!==(x=t?.store_name)&&void 0!==x?x:""})]}),(0,r.jsx)("div",{className:"vendor-info",children:(0,r.jsx)("span",{children:null!==(j=t?.vendor_delivery_options?.delivery_box_info_message)&&void 0!==j?j:""})}),(0,r.jsx)(a,{value:S?.selected_delivery_type,onClick:e=>{const t={...S,selected_delivery_type:e};O(t).then((e=>{N(e)}))},isDeliveryEnabled:t?.is_delivery_time_active,isPickupEnabled:t?.is_store_location_active}),(0,r.jsx)("input",{defaultValue:S?.delivery_date||"",readOnly:!0,ref:b,className:"delivery-time-date-picker flatpickr-input",type:"text",placeholder:null!==(f=t?.vendor_delivery_options?.delivery_date_label)&&void 0!==f?f:(0,i.__)("Delivery Date","dokan")}),Number(S.timeSlots.length)>0&&(0,r.jsx)(_,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:e=>N({...S,delivery_time_slot:e}),className:"delivery-time-vendor-select",value:null!==(w=S.delivery_time_slot)&&void 0!==w?w:"",options:(()=>{const e=S.timeSlots.map((e=>({label:e,value:e})));return e.push({label:(0,i.__)("Select time slot","dokan"),value:""}),e})()}),S.locationSlots.length>0&&"pickup"===S.selected_delivery_type&&(0,r.jsxs)("div",{className:"store-pickup-select-options",children:[(0,r.jsx)(_,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:e=>N({...S,store_pickup_location:e}),className:"delivery-time-vendor-select",value:null!==(g=S.store_pickup_location)&&void 0!==g?g:"",options:(()=>{const e=S.locationSlots.map((e=>({label:C(e).name,value:e})));return e.push({label:(0,i.__)("Select store location","dokan"),value:""}),e})()}),S.store_pickup_location&&(0,r.jsx)("div",{className:"store-address vendor-info",children:(0,r.jsx)("span",{id:"delivery-store-location-address-3",children:C(S.store_pickup_location).address})})]}),(0,r.jsx)("hr",{})]})},h=({message:e=""})=>(0,r.jsx)("div",{className:"dokan-delivery-time-error",children:(0,r.jsx)("div",{className:"dokan-delivery-time-error-message",children:(0,r.jsx)(n.RawHTML,{children:e})})}),u=window.wc.wcSettings.getSetting("dokan_delivery_time_data"),m=e=>{var t;const[o,a]=(0,n.useState)(!1),[d,c]=(0,n.useState)({}),v=null!==(t=u?.dateTime)&&void 0!==t?t:"",_=u?.vendorInfo,m={delivery_date:"",delivery_time_slot:"",locationSlots:[],selected_delivery_type:"pickup",store_name:"",store_pickup_location:"",timeSlots:[],vendor_id:"0"},y=e=>{let t="";return Object.values(e).forEach((e=>{(t||e.vendor_id)&&(t||e.store_name)?t||e.selected_delivery_type?t||e.delivery_date?t||e.delivery_time_slot?t||"pickup"!==e.selected_delivery_type||e.store_pickup_location||(t=(0,i.sprintf)((0,i.__)("Please make sure you have selected the store pickup location for %s.","dokan"),e.store_name)):t=(0,i.sprintf)((0,i.__)("Please make sure you have selected the delivery time slot for %s.","dokan"),e.store_name):t=(0,i.sprintf)((0,i.__)("Please make sure you have selected the Delivery date for %s.","dokan"),e.store_name):t=(0,i.__)("Select a delivery type.","dokan"):t=(0,i.__)("Vendor not found.","dokan")})),t};(0,n.useEffect)((()=>{const t={};Object.keys(_).forEach((e=>{let o="";_[e].is_store_location_active&&(o="pickup"),_[e].is_delivery_time_active&&(o="delivery"),t[e]={...m,selected_delivery_type:o,store_name:_[e].store_name,vendor_id:e}})),c(t),Object.values(d).length||e.onChange({data:t,error:(0,i.__)("Please select your delivery time.","dokan")})}),[]);const k=()=>{if(void 0!==u?.vendorInfo&&"object"==typeof u?.vendorInfo)return(0,r.jsxs)("div",{className:"delivery-time-body",children:[(0,r.jsx)(l,{isLoading:o}),Object.keys(_).map((t=>{return(0,r.jsx)(p,{vendorId:t,info:_[t],onChange:o=>((t,o)=>{const i={...d,[t]:o};c(i),e.onChange({data:i,error:y(i)})})(t,o),values:(o=t,d[o]),setLoading:a},t);var o}))]})},x=()=>u?.delivery_time_enabled?(0,r.jsxs)("div",{id:"dokan-delivery-time-box",children:[e.error&&(0,r.jsx)(h,{message:e.error}),(0,r.jsx)(s,{time:v}),(0,r.jsx)(k,{})]}):(0,r.jsx)(r.Fragment,{});return(0,r.jsx)(x,{})},y=window.wc.blocksCheckout,k=window.wp.plugins,x=JSON.parse('{"name":"dokan/delivery-time","version":"1.0.0","title":"Dokan delivery time","description":"Dokan delivery time checkout block","category":"woocommerce","supports":{"align":false,"html":false,"multiple":false,"reusable":false},"parent":["woocommerce/checkout-totals-block"],"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}}},"textdomain":"dokan","$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2}'),j=window.wc.wcSettings.getSetting("dokan_delivery_time_data");(0,k.registerPlugin)("dokan-delivery-time",{render:()=>"",scope:"woocommerce-checkout"}),(0,y.registerCheckoutBlock)({metadata:x,component:e=>{var t;const{checkoutExtensionData:o,extensions:i}=e,{setExtensionData:s}=o,{setValidationErrors:l,hasValidationErrors:a,getValidationError:d,clearValidationError:c,hideValidationError:v}=e.validation,_="dokan-delivery-time",[p,h]=(0,n.useState)(""),u=null!==(t=j?.vendorInfo)&&void 0!==t?t:{};return j?.delivery_time_enabled&&Object.keys(u).length?(0,r.jsx)(y.ExperimentalOrderMeta,{children:(0,r.jsx)(m,{extentionProps:e,onChange:e=>{var t;const o=null!==(t=e?.data)&&void 0!==t?t:{};h(e.error&&j?.is_time_selection_required?e.error:""),e.error&&j?.is_time_selection_required?l({[_]:{message:e.error,hidden:!1}}):c(_),(e=>{const t=Object.values(e).map((e=>{var t,o,i,r,s;return{vendor_id:null!==(t=e?.vendor_id)&&void 0!==t?t:"",store_name:null!==(o=e?.store_name)&&void 0!==o?o:"",delivery_date:null!==(i=e?.delivery_date)&&void 0!==i?i:"",selected_delivery_type:e?.selected_delivery_type&&"pickup"===e?.selected_delivery_type?"store-pickup":e?.selected_delivery_type&&"delivery"===e?.selected_delivery_type?"delivery":"",delivery_time_slot:null!==(r=e?.delivery_time_slot)&&void 0!==r?r:"",store_pickup_location:null!==(s=e?.store_pickup_location)&&void 0!==s?s:""}}));s("dokan_delivery_time","vendor_delivery_time",t)})(o)},error:p})}):(0,r.jsx)(r.Fragment,{})}})}},o={};function i(e){var r=o[e];if(void 0!==r)return r.exports;var s=o[e]={exports:{}};return t[e](s,s.exports,i),s.exports}i.m=t,e=[],i.O=(t,o,r,s)=>{if(!o){var l=1/0;for(c=0;c<e.length;c++){for(var[o,r,s]=e[c],n=!0,a=0;a<o.length;a++)(!1&s||l>=s)&&Object.keys(i.O).every((e=>i.O[e](o[a])))?o.splice(a--,1):(n=!1,s<l&&(l=s));if(n){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[o,r,s]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var o in t)i.o(t,o)&&!i.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={2894:0,8322:0};i.O.j=t=>0===e[t];var t=(t,o)=>{var r,s,[l,n,a]=o,d=0;if(l.some((t=>0!==e[t]))){for(r in n)i.o(n,r)&&(i.m[r]=n[r]);if(a)var c=a(i)}for(t&&t(o);d<l.length;d++)s=l[d],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(c)},o=globalThis.webpackChunkdokan_pro=globalThis.webpackChunkdokan_pro||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var r=i.O(void 0,[8322],(()=>i(733)));r=i.O(r)})();