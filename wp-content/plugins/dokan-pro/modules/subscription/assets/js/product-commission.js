(()=>{"use strict";var e,t={4198:()=>{window.wp.i18n;const e=function(e,t,s,i,o,n){var a,r=e;if(t&&(r.render=t,r.staticRenderFns=[],r._compiled=!0),n&&(r._scopeId="data-v-"+n),a)if(r.functional){r._injectStyles=a;var c=r.render;r.render=function(e,t){return a.call(t),c(e,t)}}else{var d=r.beforeCreate;r.beforeCreate=d?[].concat(d,a):[a]}return{exports:e,options:r}}({name:"DokanSubCommission",components:{CategoryBasedCommission:dokan_get_lib("CategoryBasedCommission"),CombineInput:dokan_get_lib("CombineInput"),Switches:dokan_get_lib("Switches")},data:()=>({selectedCommission:"fixed",commission:{},commissionTypes:{},fixedCommission:{},productId:0,wcProduct:{},resetSubCategory:!0}),created(){let e=this;window.dokanCommission&&window.dokanCommission.commissionTypes&&(this.commissionTypes=window.dokanCommission.commissionTypes),document.addEventListener("DOMContentLoaded",(function(){let t=document.getElementById("post_ID");t&&t.value&&(e.productId=t.value);let s=document.getElementById("post");s&&s.addEventListener("submit",(function(t){e.saveCommission()})),e.fetchCommission(),e.initTooltips()}))},methods:{initTooltips(){jQuery(".dokan-tooltips-help").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},commissionChanged(){this.initTooltips()},handleResetToggle(e){const t=e?this.__("Enable Commission Inheritance Setting?","dokan-lite"):this.__("Disable Commission Inheritance Setting?","dokan-lite"),s=e?this.__("Parent category commission changes will automatically update all subcategories. Existing rates will remain unchanged until parent category is modified.","dokan-lite"):this.__("Subcategories will maintain their independent commission rates when parent category rates are changed.","dokan-lite"),i=e?this.__("Enable","dokan-lite"):this.__("Disable","dokan-lite"),o=!e,n=this;Swal.fire({icon:"warning",html:s,title:t,showCancelButton:!0,cancelButtonText:this.__("Cancel","dokan-lite"),confirmButtonText:i}).then((t=>{const s=t.isConfirmed?e:o;n.resetSubCategory=s,n.resetSubCategory=s,this.$refs.resetToggle.checked=s}))},fetchCommission(){dokan.api.get(`/products/${this.productId}`).done(((e,t,s)=>{this.wcProduct=e,this.selectedCommission=this.getMetaData("_subscription_product_admin_commission_type","fixed"),this.fixedCommission={percentage:this.getMetaData("_subscription_product_admin_commission",""),fixed:this.getMetaData("_subscription_product_admin_additional_fee","")};let i=this.getMetaData("_subscription_product_admin_category_based_commission",{});i&&i.items&&Array.isArray(i.items)&&(i.items={}),this.resetSubCategory=this.getMetaData("reset_sub_category",!0),this.commission=i}))},saveCommission(){let e={product_id:this.productId,commission_type:this.selectedCommission,commission:this.processItemsForDatabase(),reset_sub_category:this.resetSubCategory};dokan.api.post("/subscription/save-commission",e)},onCategoryUpdate(e){this.commission=e},fixedCOmmissionhandler(e,t){this.fixedCommission=e},processItemsForDatabase(){let e=[],t=this.commission.hasOwnProperty("all")?this.commission.all:{},s=this.commission.hasOwnProperty("items")?this.commission.items:{};return Object.keys(s).forEach((t=>{e.push({category_id:t,...s[t]})})),{fixed:{flat:this.fixedCommission.hasOwnProperty("fixed")?this.fixedCommission.fixed:"",percentage:this.fixedCommission.hasOwnProperty("percentage")?this.fixedCommission.percentage:""},category_based:{all:t,items:e}}},getMetaData(e,t=""){return Object.values(this.wcProduct).length&&this.wcProduct.hasOwnProperty("meta_data")&&"object"==typeof this.wcProduct.meta_data?(this.wcProduct.meta_data.forEach((s=>{s.hasOwnProperty("key")&&s.key===e&&(t=s.value)})),t):t}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"dokan-layout",staticStyle:{padding:"10px"}},[t("div",{staticStyle:{"margin-bottom":"15px"}},[t("p",{staticClass:"!p-0 !m-0 !font-semibold",attrs:{for:"_subscription_product_admin_commission_type"}},[e._v(e._s(e.__("Admin Commission type","dokan")))]),e._v(" "),t("div",{staticClass:"flex flex-col"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedCommission,expression:"selectedCommission"}],staticClass:"select short",attrs:{id:"_subscription_product_admin_commission_type",name:"_subscription_product_admin_commission_type"},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedCommission=t.target.multiple?s:s[0]},e.commissionChanged]}},e._l(e.commissionTypes,(function(s,i){return t("option",{domProps:{value:i}},[e._v(e._s(s))])})),0),e._v(" "),t("span",{staticClass:"description"},[e._v(e._s(e.__("Set the commission type admin will get under this subscription","dokan")))])])]),e._v(" "),"category_based"===e.selectedCommission?t("div",[t("div",{staticClass:"flex gap-3 mb-5"},[t("p",{staticClass:"!p-0 !m-0 !font-semibold",attrs:{for:"_subscription_product_admin_commission_type"}},[e._v("\n                "+e._s(e.__("Apply Parent Category Commission to All Subcategories ","dokan-lite"))+"\n            ")]),e._v(" "),t("label",{staticClass:"relative inline-flex items-center cursor-pointer !p-0 !m-0"},[t("input",{ref:"resetToggle",staticClass:"sr-only peer",attrs:{type:"checkbox"},domProps:{checked:e.resetSubCategory},on:{input:function(t){return e.handleResetToggle(!e.resetSubCategory)}}}),e._v(" "),t("div",{staticClass:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})])]),e._v(" "),t("div",[t("p",{staticClass:"!p-0 !m-0 !font-semibold",attrs:{for:"_subscription_product_admin_commission_type"}},[e._v("\n                "+e._s(e.__("Admin Commission","dokan"))+"\n\n                "),t("span",{staticClass:"dokan-tooltips-help",attrs:{"data-tip":e.__("When the value is 0, no commissions will be deducted from this vendor.","dokan")}},[t("i",{staticClass:"fas fa-question-circle"})])]),e._v(" "),t("category-based-commission",{attrs:{value:e.commission,resetSubCategory:e.resetSubCategory},on:{change:e.onCategoryUpdate}})],1)]):"fixed"===e.selectedCommission?t("div",[t("p",{staticClass:"!p-0 !m-0 !font-semibold",attrs:{for:"_subscription_product_admin_commission_type"}},[e._v("\n            "+e._s(e.__("Admin Commission","dokan"))+"\n\n            "),t("span",{staticClass:"dokan-tooltips-help",attrs:{"data-tip":e.__("When the value is 0, no commissions will be deducted from this vendor.","dokan")}},[t("i",{staticClass:"fas fa-question-circle"})])]),e._v(" "),t("combine-input",{attrs:{value:e.fixedCommission},on:{change:e.fixedCOmmissionhandler}})],1):e._e()])}),0,0,0,"7bbc5e72").exports;new(dokan_get_lib("Vue"))({el:"#dokan_product_pack_commission_data_section",render:t=>t(e)})}},s={};function i(e){var o=s[e];if(void 0!==o)return o.exports;var n=s[e]={exports:{}};return t[e](n,n.exports,i),n.exports}i.m=t,e=[],i.O=(t,s,o,n)=>{if(!s){var a=1/0;for(m=0;m<e.length;m++){for(var[s,o,n]=e[m],r=!0,c=0;c<s.length;c++)(!1&n||a>=n)&&Object.keys(i.O).every((e=>i.O[e](s[c])))?s.splice(c--,1):(r=!1,n<a&&(a=n));if(r){e.splice(m--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var m=e.length;m>0&&e[m-1][2]>n;m--)e[m]=e[m-1];e[m]=[s,o,n]},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={1792:0,7624:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var o,n,[a,r,c]=s,d=0;if(a.some((t=>0!==e[t]))){for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(c)var m=c(i)}for(t&&t(s);d<a.length;d++)n=a[d],i.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return i.O(m)},s=globalThis.webpackChunkdokan_pro=globalThis.webpackChunkdokan_pro||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var o=i.O(void 0,[7624],(()=>i(4198)));o=i.O(o)})();