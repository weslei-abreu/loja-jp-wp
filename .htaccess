# BEGIN iThemes Security - Do not modify or remove this line
# iThemes Security Config Details: 2
	# Protect System Files - Security > Settings > System Tweaks > System Files
	<files .htaccess>
		<IfModule mod_authz_core.c>
			Require all denied
		</IfModule>
		<IfModule !mod_authz_core.c>
			Order allow,deny
			Deny from all
		</IfModule>
	</files>
	<files readme.html>
		<IfModule mod_authz_core.c>
			Require all denied
		</IfModule>
		<IfModule !mod_authz_core.c>
			Order allow,deny
			Deny from all
		</IfModule>
	</files>
	<files readme.txt>
		<IfModule mod_authz_core.c>
			Require all denied
		</IfModule>
		<IfModule !mod_authz_core.c>
			Order allow,deny
			Deny from all
		</IfModule>
	</files>
	<files wp-config.php>
		<IfModule mod_authz_core.c>
			Require all denied
		</IfModule>
		<IfModule !mod_authz_core.c>
			Order allow,deny
			Deny from all
		</IfModule>
	</files>

	# Disable Directory Browsing - Security > Settings > System Tweaks > Directory Browsing
	Options -Indexes

	<IfModule mod_rewrite.c>
		RewriteEngine On

		# Protect System Files - Security > Settings > System Tweaks > System Files
		RewriteRule ^wp-admin/install\.php$ - [F]
		RewriteRule ^wp-admin/includes/ - [F]
		RewriteRule !^wp-includes/ - [S=3]
		RewriteRule ^wp-includes/[^/]+\.php$ - [F]
		RewriteRule ^wp-includes/js/tinymce/langs/.+\.php - [F]
		RewriteRule ^wp-includes/theme-compat/ - [F]
		RewriteCond %{REQUEST_FILENAME} -f
		RewriteRule (^|.*/)\.(git|svn)/.* - [F]

		# Disable PHP in Uploads - Security > Settings > System Tweaks > PHP in Uploads
		RewriteRule ^wp\-content/uploads/.*\.(?:php[1-7]?|pht|phtml?|phps)\.?$ - [NC,F]

		# Disable PHP in Plugins - Security > Settings > System Tweaks > PHP in Plugins
		RewriteRule ^wp\-content/plugins/.*\.(?:php[1-7]?|pht|phtml?|phps)\.?$ - [NC,F]

		# Disable PHP in Themes - Security > Settings > System Tweaks > PHP in Themes
		RewriteRule ^wp\-content/themes/.*\.(?:php[1-7]?|pht|phtml?|phps)\.?$ - [NC,F]
	</IfModule>
# END iThemes Security - Do not modify or remove this line

# BEGIN WpFastestCache
# Modified Time: 04-08-25 17:06:54
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteCond %{HTTPS} =on
RewriteCond %{HTTP_HOST} ^loja.jp
# Start WPFC Exclude
RewriteCond %{REQUEST_URI} !\/wishlist [NC]
# End WPFC Exclude
# Start_WPFC_Exclude_Admin_Cookie
RewriteCond %{HTTP:Cookie} !wordpress_logged_in_[^\=]+\=admin|adminit|adminit2|creative|emmanuelcaceres|j1seedsadmin|Jaqueito|sabrina-4151|sns2admin|trafego
# End_WPFC_Exclude_Admin_Cookie
RewriteCond %{HTTP_HOST} ^loja.jp
RewriteCond %{HTTP_USER_AGENT} !(facebookexternalhit|WP_FASTEST_CACHE_CSS_VALIDATOR|Twitterbot|LinkedInBot|WhatsApp|Mediatoolkitbot)
RewriteCond %{HTTP_USER_AGENT} !(WP\sFastest\sCache\sPreload(\siPhone\sMobile)?\s*Bot)
RewriteCond %{REQUEST_METHOD} !POST
RewriteCond %{REQUEST_URI} !(\/){2,}
RewriteCond %{THE_REQUEST} !(\/){2,}
RewriteCond %{REQUEST_URI} \/$
RewriteCond %{QUERY_STRING} !.+ [OR]
RewriteCond %{QUERY_STRING} fbclid=
RewriteCond %{HTTP:Cookie} !wordpress_logged_in
RewriteCond %{HTTP:Cookie} !comment_author_
RewriteCond %{HTTP:Profile} !^[a-z0-9\"]+ [NC]
RewriteCond %{DOCUMENT_ROOT}/wp-content/cache/all/$1/index.html -f [or]
RewriteCond /var/www/wordpress/wp-content/cache/all/$1/index.html -f
RewriteRule ^(.*) "/wp-content/cache/all/$1/index.html" [L]
</IfModule>
<FilesMatch "index\.(html|htm)$">
AddDefaultCharset UTF-8
<ifModule mod_headers.c>
FileETag None
Header unset ETag
Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
Header set Pragma "no-cache"
Header set Expires "Mon, 29 Oct 1923 20:30:00 GMT"
</ifModule>
</FilesMatch>
# END WpFastestCache
# BEGIN GzipWpFastestCache
<IfModule mod_deflate.c>
AddType x-font/woff .woff
AddType x-font/ttf .ttf
AddOutputFilterByType DEFLATE image/svg+xml
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
AddOutputFilterByType DEFLATE application/x-font-ttf
AddOutputFilterByType DEFLATE x-font/ttf
AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
AddOutputFilterByType DEFLATE font/opentype font/ttf font/eot font/otf
</IfModule>
# END GzipWpFastestCache
# BEGIN LBCWpFastestCache
<FilesMatch "\.(webm|ogg|mp4|ico|pdf|flv|avif|jpg|jpeg|png|gif|webp|js|css|swf|x-html|xml|woff|woff2|otf|ttf|svg|eot)(\.gz)?$">
<IfModule mod_expires.c>
AddType application/font-woff2 .woff2
AddType application/x-font-opentype .otf
ExpiresActive On
ExpiresDefault A0
ExpiresByType video/webm A10368000
ExpiresByType video/ogg A10368000
ExpiresByType video/mp4 A10368000
ExpiresByType image/avif A10368000
ExpiresByType image/webp A10368000
ExpiresByType image/gif A10368000
ExpiresByType image/png A10368000
ExpiresByType image/jpg A10368000
ExpiresByType image/jpeg A10368000
ExpiresByType image/ico A10368000
ExpiresByType image/svg+xml A10368000
ExpiresByType text/css A10368000
ExpiresByType text/javascript A10368000
ExpiresByType application/javascript A10368000
ExpiresByType application/x-javascript A10368000
ExpiresByType application/font-woff2 A10368000
ExpiresByType application/x-font-opentype A10368000
ExpiresByType application/x-font-truetype A10368000
</IfModule>
<IfModule mod_headers.c>
Header set Expires "max-age=A10368000, public"
Header unset ETag
Header set Connection keep-alive
FileETag None
</IfModule>
</FilesMatch>
# END LBCWpFastestCache

# BEGIN HMWP_RULES
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule ^([0-9a-zA-Z_-]+/)?ajax$ /wp-admin/admin-ajax.php [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?newlogin$ /wp-login.php [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?newlogin/(.*) /wp-login.php$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?lostpass$ /wp-login.php?action=lostpassword [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?register$ /wp-login.php?action=register [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/d0f4711431/(.*) /wp-content/plugins/hide-my-wp/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/e406a11b72/(.*) /wp-content/plugins/redux-framework/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/1a03f1c702/(.*) /wp-content/plugins/akismet/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/1e06e6f5cf/(.*) /wp-content/plugins/all-in-one-wp-migration-unlimited-extension/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/e39123425b/(.*) /wp-content/plugins/all-in-one-wp-migration/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/1f0fda2e0a/(.*) /wp-content/plugins/automatic-translator-addon-for-loco-translate/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/c419573b69/(.*) /wp-content/plugins/better-wp-security/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/a0d6002f7e/(.*) /wp-content/plugins/cmb2/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/e4ab27d56b/(.*) /wp-content/plugins/dokan-lite/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/d938da7cdf/(.*) /wp-content/plugins/dokan-pro/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/ccc473c329/(.*) /wp-content/plugins/elementor-pro/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/f65f29574d/(.*) /wp-content/plugins/elementor/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/85e5f69829/(.*) /wp-content/plugins/loco-translate/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/7c2f8b72c1/(.*) /wp-content/plugins/login-customizer/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/8c6b2640d1/(.*) /wp-content/plugins/mailchimp-for-wp/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/29c485126a/(.*) /wp-content/plugins/password-bcrypt/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/80a7b0f1b3/(.*) /wp-content/plugins/regenerate-thumbnails/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/4b36101dcc/(.*) /wp-content/plugins/revslider/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/90208f68a8/(.*) /wp-content/plugins/tbay-elementor/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/f7130ba3dd/(.*) /wp-content/plugins/woocommerce-conversion-tracking/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/e09af06241/(.*) /wp-content/plugins/woocommerce-products-filter/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/b70cc6f7c0/(.*) /wp-content/plugins/woocommerce-simple-auctions/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/39d10ee62c/(.*) /wp-content/plugins/woocommerce/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/067a15d05a/(.*) /wp-content/plugins/wpforms-lite/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/140347125a/(.*) /wp-content/plugins/yith-woocommerce-wishlist/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/modules/(.*) /wp-content/plugins/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/views/bda853284f/design.css$ /wp-content/themes/zota-child/style.css [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/views/bda853284f/(.*) /wp-content/themes/zota-child/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/views/8c977a7755/design.css$ /wp-content/themes/zota/style.css [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/views/8c977a7755/(.*) /wp-content/themes/zota/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/views/(.*) /wp-content/themes/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?storage/(.*) /wp-content/uploads/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?core/(.*) /wp-content/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?lib/(.*) /wp-includes/$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?comments/(.*) /wp-comments-post.php$2 [QSA,NC,L]
RewriteRule ^([0-9a-zA-Z_-]+/)?writer/(.*) /author/$2 [QSA,NC,L]
</IfModule>
# END HMWP_RULES
# BEGIN HMWP_VULNERABILITY
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_URI} !/wp-admin [NC]
RewriteCond %{QUERY_STRING} ^author=\d+ [NC]
RewriteRule ^(.*)$ - [L,R=404]
</IfModule>
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REMOTE_ADDR} ^35.214.130.87$ [NC,OR]
RewriteCond %{REMOTE_ADDR} ^192.185.4.40$ [NC,OR]
RewriteCond %{REMOTE_ADDR} ^15.235.50.223$ [NC,OR]
RewriteCond %{REMOTE_ADDR} ^172.105.48.130$ [NC,OR]
RewriteCond %{REMOTE_ADDR} ^167.99.233.123$ [NC,OR]
RewriteCond %{HTTP_USER_AGENT} (wpthemedetector|builtwith|isitwp|wapalyzer|mShots|WhatCMS|gochyu|wpdetector|scanwp) [NC]
RewriteRule ^(.*)$ - [L,R=404]
</IfModule>
<IfModule mod_headers.c>
Header always unset x-powered-by
Header always unset server
ServerSignature Off
</IfModule>
<IfModule mod_headers.c>
Header set Strict-Transport-Security "max-age=15768000;includeSubdomains"
Header set Content-Security-Policy "object-src 'none'"
Header set X-XSS-Protection "1; mode=block"
</IfModule>
# END HMWP_VULNERABILITY

# BLOQUEAR BOTS PESADOS
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{HTTP_USER_AGENT} (SemrushBot|MJ12bot|ClaudeBot|Bytespider) [NC]
RewriteRule .* - [F,L]
</IfModule>

<Files "admin-ajax.php">
    <IfModule mod_setenvif.c>
        SetEnvIfNoCase User-Agent "bot" bad_bot
        SetEnvIfNoCase User-Agent "crawl" bad_bot
        SetEnvIfNoCase User-Agent "spider" bad_bot
        SetEnvIfNoCase User-Agent "python-requests" bad_bot
    </IfModule>
    Order Allow,Deny
    Allow from all
    Deny from env=bad_bot
</Files>

# BLOQUEAR add-to-cart por bots no produto
<If "%{REQUEST_URI} =~ m#\?add-to-cart=# && %{HTTP_USER_AGENT} =~ /bot|crawl|spider|python-requests/i">
    Require all denied
</If>
# BLOQUEAR qualquer requisição com ?add-to-cart= feita por bots
<If "%{QUERY_STRING} =~ /add-to-cart=/ && %{HTTP_USER_AGENT} =~ /bot|crawl|spider|python-requests/i">
    Require all denied
</If>

# BLOQUEAR requisições POST em /ajax feitas por bots
<If "%{REQUEST_URI} =~ m#^/ajax# && %{REQUEST_METHOD} == 'POST' && %{HTTP_USER_AGENT} =~ /bot|crawl|spider|python-requests/i">
    Require all denied
</If>


# BLOQUEIO CENTRALIZADO DE BOTS
<IfModule mod_rewrite.c>
RewriteEngine On

# Bots abusivos específicos
RewriteCond %{HTTP_USER_AGENT} (SemrushBot|MJ12bot|ClaudeBot|Bytespider|AhrefsBot|DotBot|ZoominfoBot|python-requests|curl|libwww-perl) [NC]
RewriteRule .* - [F,L]

# Bloquear bots tentando acessar /ajax diretamente
RewriteCond %{REQUEST_URI} ^/ajax$
RewriteCond %{HTTP_USER_AGENT} (bot|crawl|spider|python-requests|curl|wget) [NC]
RewriteRule .* - [F,L]

# Bloquear bots fazendo POST em /ajax
<If "%{REQUEST_URI} =~ m#^/ajax# && %{REQUEST_METHOD} == 'POST' && %{HTTP_USER_AGENT} =~ /bot|crawl|spider|python-requests/i">
    Require all denied
</If>

# Bloquear ?add-to-cart= por bots
<If "%{QUERY_STRING} =~ /add-to-cart=/ && %{HTTP_USER_AGENT} =~ /bot|crawl|spider|python-requests/i">
    Require all denied
</If>
</IfModule>

# Admin-Ajax: negar acesso se for bot
<Files "admin-ajax.php">
    <IfModule mod_setenvif.c>
        SetEnvIfNoCase User-Agent "bot" bad_bot
        SetEnvIfNoCase User-Agent "crawl" bad_bot
        SetEnvIfNoCase User-Agent "spider" bad_bot
        SetEnvIfNoCase User-Agent "python-requests" bad_bot
    </IfModule>
    Order Allow,Deny
    Allow from all
    Deny from env=bad_bot
</Files>

# BEGIN WordPress
# As diretrizes (linhas) entre "BEGIN WordPress" e "END WordPress" são
# geradas dinamicamente e só devem ser modificadas através de filtros do WordPress.
# Quaisquer alterações nas diretivas entre esses marcadores serão sobrescritas.
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress
<IfModule mod_rewrite.c>
RewriteEngine On

# Bloquear bots acessando /ajax diretamente
RewriteCond %{REQUEST_URI} ^/ajax$
RewriteCond %{HTTP_USER_AGENT} (bot|crawl|spider|python-requests) [NC]
RewriteRule ^.* - [F,L]
</IfModule>
